2025-03-08 22:28:27,599 - INFO - 开始训练主模型...
2025-03-08 22:28:27,600 - INFO - 使用的股票: ['BABA', 'JD', 'PDD', 'BIDU', 'TCEHY', 'NIO', 'NTES', 'BILI', 'TAL', 'YUMC', 'LI', 'XPEV', 'TME', 'HTHT', 'ZTO']
2025-03-08 22:28:27,601 - INFO - 处理股票 BABA (1/15) 的数据...
2025-03-08 22:28:27,601 - INFO - 下载 BABA 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:28:29,393 - INFO - 成功获取 2514 行 BABA 的数据
2025-03-08 22:28:29,394 - INFO - 为 BABA 创建特征...
2025-03-08 22:28:29,494 - INFO - 获取市场指数数据...
2025-03-08 22:28:30,263 - INFO - 已添加 2514 行来自 BABA 的数据
2025-03-08 22:28:30,263 - INFO - 特征数据索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-08 22:28:30,263 - INFO - 处理股票 JD (2/15) 的数据...
2025-03-08 22:28:30,263 - INFO - 下载 JD 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:28:30,575 - INFO - 成功获取 2514 行 JD 的数据
2025-03-08 22:28:30,576 - INFO - 为 JD 创建特征...
2025-03-08 22:28:30,671 - INFO - 获取市场指数数据...
2025-03-08 22:28:30,768 - INFO - 已添加 2514 行来自 JD 的数据
2025-03-08 22:28:30,768 - INFO - 处理股票 PDD (3/15) 的数据...
2025-03-08 22:28:30,768 - INFO - 下载 PDD 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:28:31,045 - INFO - 成功获取 1663 行 PDD 的数据
2025-03-08 22:28:31,046 - INFO - 为 PDD 创建特征...
2025-03-08 22:28:31,138 - INFO - 获取市场指数数据...
2025-03-08 22:28:31,246 - INFO - 已添加 1663 行来自 PDD 的数据
2025-03-08 22:28:31,246 - INFO - 处理股票 BIDU (4/15) 的数据...
2025-03-08 22:28:31,246 - INFO - 下载 BIDU 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:28:31,684 - INFO - 成功获取 2514 行 BIDU 的数据
2025-03-08 22:28:31,684 - INFO - 为 BIDU 创建特征...
2025-03-08 22:28:31,778 - INFO - 获取市场指数数据...
2025-03-08 22:28:31,872 - INFO - 已添加 2514 行来自 BIDU 的数据
2025-03-08 22:28:31,872 - INFO - 处理股票 TCEHY (5/15) 的数据...
2025-03-08 22:28:31,872 - INFO - 下载 TCEHY 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:28:32,361 - INFO - 成功获取 2514 行 TCEHY 的数据
2025-03-08 22:28:32,362 - INFO - 为 TCEHY 创建特征...
2025-03-08 22:28:32,454 - INFO - 获取市场指数数据...
2025-03-08 22:28:32,549 - INFO - 已添加 2514 行来自 TCEHY 的数据
2025-03-08 22:28:32,549 - INFO - 暂停2秒，避免达到API限制...
2025-03-08 22:28:34,555 - INFO - 处理股票 NIO (6/15) 的数据...
2025-03-08 22:28:34,556 - INFO - 下载 NIO 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:28:35,392 - INFO - 成功获取 1630 行 NIO 的数据
2025-03-08 22:28:35,393 - INFO - 为 NIO 创建特征...
2025-03-08 22:28:35,484 - INFO - 获取市场指数数据...
2025-03-08 22:28:35,621 - INFO - 已添加 1630 行来自 NIO 的数据
2025-03-08 22:28:35,622 - INFO - 处理股票 NTES (7/15) 的数据...
2025-03-08 22:28:35,622 - INFO - 下载 NTES 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:28:36,149 - INFO - 成功获取 2514 行 NTES 的数据
2025-03-08 22:28:36,150 - INFO - 为 NTES 创建特征...
2025-03-08 22:28:36,241 - INFO - 获取市场指数数据...
2025-03-08 22:28:36,334 - INFO - 已添加 2514 行来自 NTES 的数据
2025-03-08 22:28:36,334 - INFO - 处理股票 BILI (8/15) 的数据...
2025-03-08 22:28:36,334 - INFO - 下载 BILI 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:28:36,774 - INFO - 成功获取 1746 行 BILI 的数据
2025-03-08 22:28:36,775 - INFO - 为 BILI 创建特征...
2025-03-08 22:28:36,867 - INFO - 获取市场指数数据...
2025-03-08 22:28:36,963 - INFO - 已添加 1746 行来自 BILI 的数据
2025-03-08 22:28:36,963 - INFO - 处理股票 TAL (9/15) 的数据...
2025-03-08 22:28:36,964 - INFO - 下载 TAL 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:28:37,653 - INFO - 成功获取 2514 行 TAL 的数据
2025-03-08 22:28:37,653 - INFO - 为 TAL 创建特征...
2025-03-08 22:28:37,746 - INFO - 获取市场指数数据...
2025-03-08 22:28:37,838 - INFO - 已添加 2514 行来自 TAL 的数据
2025-03-08 22:28:37,838 - INFO - 处理股票 YUMC (10/15) 的数据...
2025-03-08 22:28:37,839 - INFO - 下载 YUMC 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:28:38,511 - INFO - 成功获取 2109 行 YUMC 的数据
2025-03-08 22:28:38,511 - INFO - 为 YUMC 创建特征...
2025-03-08 22:28:38,606 - INFO - 获取市场指数数据...
2025-03-08 22:28:38,702 - INFO - 已添加 2109 行来自 YUMC 的数据
2025-03-08 22:28:38,702 - INFO - 暂停2秒，避免达到API限制...
2025-03-08 22:28:40,708 - INFO - 处理股票 LI (11/15) 的数据...
2025-03-08 22:28:40,709 - INFO - 下载 LI 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:28:41,399 - INFO - 成功获取 1157 行 LI 的数据
2025-03-08 22:28:41,400 - INFO - 为 LI 创建特征...
2025-03-08 22:28:41,493 - INFO - 获取市场指数数据...
2025-03-08 22:28:41,590 - INFO - 已添加 1157 行来自 LI 的数据
2025-03-08 22:28:41,590 - INFO - 处理股票 XPEV (12/15) 的数据...
2025-03-08 22:28:41,590 - INFO - 下载 XPEV 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:28:42,231 - INFO - 成功获取 1137 行 XPEV 的数据
2025-03-08 22:28:42,232 - INFO - 为 XPEV 创建特征...
2025-03-08 22:28:42,323 - INFO - 获取市场指数数据...
2025-03-08 22:28:42,419 - INFO - 已添加 1137 行来自 XPEV 的数据
2025-03-08 22:28:42,419 - INFO - 处理股票 TME (13/15) 的数据...
2025-03-08 22:28:42,419 - INFO - 下载 TME 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:28:43,109 - INFO - 成功获取 1567 行 TME 的数据
2025-03-08 22:28:43,110 - INFO - 为 TME 创建特征...
2025-03-08 22:28:43,200 - INFO - 获取市场指数数据...
2025-03-08 22:28:43,295 - INFO - 已添加 1567 行来自 TME 的数据
2025-03-08 22:28:43,296 - INFO - 处理股票 HTHT (14/15) 的数据...
2025-03-08 22:28:43,296 - INFO - 下载 HTHT 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:28:43,999 - INFO - 成功获取 2514 行 HTHT 的数据
2025-03-08 22:28:43,999 - INFO - 为 HTHT 创建特征...
2025-03-08 22:28:44,091 - INFO - 获取市场指数数据...
2025-03-08 22:28:44,184 - INFO - 已添加 2514 行来自 HTHT 的数据
2025-03-08 22:28:44,184 - INFO - 处理股票 ZTO (15/15) 的数据...
2025-03-08 22:28:44,184 - INFO - 下载 ZTO 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:28:44,868 - INFO - 成功获取 2101 行 ZTO 的数据
2025-03-08 22:28:44,868 - INFO - 为 ZTO 创建特征...
2025-03-08 22:28:44,959 - INFO - 获取市场指数数据...
2025-03-08 22:28:45,056 - INFO - 已添加 2101 行来自 ZTO 的数据
2025-03-08 22:28:45,056 - INFO - 暂停2秒，避免达到API限制...
2025-03-08 22:28:47,062 - INFO - 总共收集了 30708 行数据
2025-03-08 22:28:47,063 - WARNING - 合并后的数据索引不是日期类型，这可能影响时间序列分析
2025-03-08 22:28:47,063 - INFO - 索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-08 22:28:47,073 - INFO - 索引示例: MultiIndex([('2015-03-11', 'BABA'),
            ('2015-03-12', 'BABA'),
            ('2015-03-13', 'BABA'),
            ('2015-03-16', 'BABA'),
            ('2015-03-17', 'BABA')],
           names=['Date', 'ticker_temp'])
2025-03-08 22:28:47,073 - INFO - 检测到MultiIndex，提取日期部分和股票标识...
2025-03-08 22:28:47,076 - INFO - 日期范围: 2015-03-11 00:00:00 到 2025-03-07 00:00:00
2025-03-08 22:28:47,079 - INFO - 不同股票数量: 15
2025-03-08 22:29:20,329 - INFO - 开始训练主模型...
2025-03-08 22:29:20,329 - INFO - 使用的股票: ['BABA', 'JD', 'PDD', 'BIDU', 'TCEHY', 'NIO', 'NTES', 'BILI', 'TAL', 'YUMC', 'LI', 'XPEV', 'TME', 'HTHT', 'ZTO']
2025-03-08 22:29:20,330 - INFO - 处理股票 BABA (1/15) 的数据...
2025-03-08 22:29:20,330 - INFO - 下载 BABA 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:29:21,898 - INFO - 成功获取 2514 行 BABA 的数据
2025-03-08 22:29:21,899 - INFO - 为 BABA 创建特征...
2025-03-08 22:33:56,218 - INFO - 开始训练主模型...
2025-03-08 22:33:56,218 - INFO - 使用的股票: ['BABA', 'JD', 'PDD', 'BIDU', 'TCEHY', 'NIO', 'NTES', 'BILI', 'TAL', 'YUMC', 'LI', 'XPEV', 'TME', 'HTHT', 'ZTO', 'VIPS', 'ATHM', 'BEKE', 'FUTU', 'DADA', 'IQ', 'GDS', 'BGNE', 'EDU', 'VNET', 'WB', 'YY', 'JOBS', 'MOMO', 'NOAH']
2025-03-08 22:33:56,219 - INFO - 处理股票 BABA (1/30) 的数据...
2025-03-08 22:33:56,219 - INFO - 下载 BABA 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:33:57,894 - INFO - 成功获取 2514 行 BABA 的数据
2025-03-08 22:33:57,895 - INFO - 为 BABA 创建特征...
2025-03-08 22:33:57,993 - INFO - 获取市场指数数据...
2025-03-08 22:33:58,882 - INFO - 已添加 2514 行来自 BABA 的数据
2025-03-08 22:33:58,882 - INFO - 特征数据索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-08 22:33:58,882 - INFO - 处理股票 JD (2/30) 的数据...
2025-03-08 22:33:58,882 - INFO - 下载 JD 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:33:59,198 - INFO - 成功获取 2514 行 JD 的数据
2025-03-08 22:33:59,199 - INFO - 为 JD 创建特征...
2025-03-08 22:33:59,292 - INFO - 获取市场指数数据...
2025-03-08 22:33:59,392 - INFO - 已添加 2514 行来自 JD 的数据
2025-03-08 22:33:59,392 - INFO - 处理股票 PDD (3/30) 的数据...
2025-03-08 22:33:59,392 - INFO - 下载 PDD 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:33:59,687 - INFO - 成功获取 1663 行 PDD 的数据
2025-03-08 22:33:59,687 - INFO - 为 PDD 创建特征...
2025-03-08 22:33:59,779 - INFO - 获取市场指数数据...
2025-03-08 22:33:59,876 - INFO - 已添加 1663 行来自 PDD 的数据
2025-03-08 22:33:59,876 - INFO - 处理股票 BIDU (4/30) 的数据...
2025-03-08 22:33:59,876 - INFO - 下载 BIDU 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:00,349 - INFO - 成功获取 2514 行 BIDU 的数据
2025-03-08 22:34:00,350 - INFO - 为 BIDU 创建特征...
2025-03-08 22:34:00,444 - INFO - 获取市场指数数据...
2025-03-08 22:34:00,537 - INFO - 已添加 2514 行来自 BIDU 的数据
2025-03-08 22:34:00,537 - INFO - 处理股票 TCEHY (5/30) 的数据...
2025-03-08 22:34:00,537 - INFO - 下载 TCEHY 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:01,051 - INFO - 成功获取 2514 行 TCEHY 的数据
2025-03-08 22:34:01,052 - INFO - 为 TCEHY 创建特征...
2025-03-08 22:34:01,144 - INFO - 获取市场指数数据...
2025-03-08 22:34:01,278 - INFO - 已添加 2514 行来自 TCEHY 的数据
2025-03-08 22:34:01,278 - INFO - 暂停2秒，避免达到API限制...
2025-03-08 22:34:03,283 - INFO - 处理股票 NIO (6/30) 的数据...
2025-03-08 22:34:03,284 - INFO - 下载 NIO 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:03,912 - INFO - 成功获取 1630 行 NIO 的数据
2025-03-08 22:34:03,912 - INFO - 为 NIO 创建特征...
2025-03-08 22:34:04,005 - INFO - 获取市场指数数据...
2025-03-08 22:34:04,109 - INFO - 已添加 1630 行来自 NIO 的数据
2025-03-08 22:34:04,109 - INFO - 处理股票 NTES (7/30) 的数据...
2025-03-08 22:34:04,109 - INFO - 下载 NTES 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:04,793 - INFO - 成功获取 2514 行 NTES 的数据
2025-03-08 22:34:04,793 - INFO - 为 NTES 创建特征...
2025-03-08 22:34:04,887 - INFO - 获取市场指数数据...
2025-03-08 22:34:04,981 - INFO - 已添加 2514 行来自 NTES 的数据
2025-03-08 22:34:04,981 - INFO - 处理股票 BILI (8/30) 的数据...
2025-03-08 22:34:04,982 - INFO - 下载 BILI 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:05,249 - INFO - 成功获取 1746 行 BILI 的数据
2025-03-08 22:34:05,250 - INFO - 为 BILI 创建特征...
2025-03-08 22:34:05,347 - INFO - 获取市场指数数据...
2025-03-08 22:34:05,445 - INFO - 已添加 1746 行来自 BILI 的数据
2025-03-08 22:34:05,445 - INFO - 处理股票 TAL (9/30) 的数据...
2025-03-08 22:34:05,445 - INFO - 下载 TAL 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:05,934 - INFO - 成功获取 2514 行 TAL 的数据
2025-03-08 22:34:05,935 - INFO - 为 TAL 创建特征...
2025-03-08 22:34:06,028 - INFO - 获取市场指数数据...
2025-03-08 22:34:06,123 - INFO - 已添加 2514 行来自 TAL 的数据
2025-03-08 22:34:06,124 - INFO - 处理股票 YUMC (10/30) 的数据...
2025-03-08 22:34:06,124 - INFO - 下载 YUMC 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:06,608 - INFO - 成功获取 2109 行 YUMC 的数据
2025-03-08 22:34:06,609 - INFO - 为 YUMC 创建特征...
2025-03-08 22:34:06,703 - INFO - 获取市场指数数据...
2025-03-08 22:34:06,800 - INFO - 已添加 2109 行来自 YUMC 的数据
2025-03-08 22:34:06,800 - INFO - 暂停2秒，避免达到API限制...
2025-03-08 22:34:08,806 - INFO - 处理股票 LI (11/30) 的数据...
2025-03-08 22:34:08,807 - INFO - 下载 LI 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:09,283 - INFO - 成功获取 1157 行 LI 的数据
2025-03-08 22:34:09,284 - INFO - 为 LI 创建特征...
2025-03-08 22:34:09,375 - INFO - 获取市场指数数据...
2025-03-08 22:34:09,477 - INFO - 已添加 1157 行来自 LI 的数据
2025-03-08 22:34:09,477 - INFO - 处理股票 XPEV (12/30) 的数据...
2025-03-08 22:34:09,477 - INFO - 下载 XPEV 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:09,950 - INFO - 成功获取 1137 行 XPEV 的数据
2025-03-08 22:34:09,951 - INFO - 为 XPEV 创建特征...
2025-03-08 22:34:10,043 - INFO - 获取市场指数数据...
2025-03-08 22:34:10,138 - INFO - 已添加 1137 行来自 XPEV 的数据
2025-03-08 22:34:10,139 - INFO - 处理股票 TME (13/30) 的数据...
2025-03-08 22:34:10,139 - INFO - 下载 TME 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:10,581 - INFO - 成功获取 1567 行 TME 的数据
2025-03-08 22:34:10,582 - INFO - 为 TME 创建特征...
2025-03-08 22:34:10,675 - INFO - 获取市场指数数据...
2025-03-08 22:34:10,771 - INFO - 已添加 1567 行来自 TME 的数据
2025-03-08 22:34:10,771 - INFO - 处理股票 HTHT (14/30) 的数据...
2025-03-08 22:34:10,771 - INFO - 下载 HTHT 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:11,270 - INFO - 成功获取 2514 行 HTHT 的数据
2025-03-08 22:34:11,271 - INFO - 为 HTHT 创建特征...
2025-03-08 22:34:11,365 - INFO - 获取市场指数数据...
2025-03-08 22:34:11,473 - INFO - 已添加 2514 行来自 HTHT 的数据
2025-03-08 22:34:11,474 - INFO - 处理股票 ZTO (15/30) 的数据...
2025-03-08 22:34:11,474 - INFO - 下载 ZTO 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:11,946 - INFO - 成功获取 2101 行 ZTO 的数据
2025-03-08 22:34:11,947 - INFO - 为 ZTO 创建特征...
2025-03-08 22:34:12,038 - INFO - 获取市场指数数据...
2025-03-08 22:34:12,135 - INFO - 已添加 2101 行来自 ZTO 的数据
2025-03-08 22:34:12,135 - INFO - 暂停2秒，避免达到API限制...
2025-03-08 22:34:14,141 - INFO - 处理股票 VIPS (16/30) 的数据...
2025-03-08 22:34:14,142 - INFO - 下载 VIPS 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:15,053 - INFO - 成功获取 2514 行 VIPS 的数据
2025-03-08 22:34:15,053 - INFO - 为 VIPS 创建特征...
2025-03-08 22:34:15,145 - INFO - 获取市场指数数据...
2025-03-08 22:34:15,240 - INFO - 已添加 2514 行来自 VIPS 的数据
2025-03-08 22:34:15,240 - INFO - 处理股票 ATHM (17/30) 的数据...
2025-03-08 22:34:15,240 - INFO - 下载 ATHM 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:15,952 - INFO - 成功获取 2514 行 ATHM 的数据
2025-03-08 22:34:15,952 - INFO - 为 ATHM 创建特征...
2025-03-08 22:34:16,044 - INFO - 获取市场指数数据...
2025-03-08 22:34:16,138 - INFO - 已添加 2514 行来自 ATHM 的数据
2025-03-08 22:34:16,139 - INFO - 处理股票 BEKE (18/30) 的数据...
2025-03-08 22:34:16,139 - INFO - 下载 BEKE 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:16,664 - INFO - 成功获取 1147 行 BEKE 的数据
2025-03-08 22:34:16,665 - INFO - 为 BEKE 创建特征...
2025-03-08 22:34:16,755 - INFO - 获取市场指数数据...
2025-03-08 22:34:16,851 - INFO - 已添加 1147 行来自 BEKE 的数据
2025-03-08 22:34:16,851 - INFO - 处理股票 FUTU (19/30) 的数据...
2025-03-08 22:34:16,852 - INFO - 下载 FUTU 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:17,539 - INFO - 成功获取 1509 行 FUTU 的数据
2025-03-08 22:34:17,539 - INFO - 为 FUTU 创建特征...
2025-03-08 22:34:17,631 - INFO - 获取市场指数数据...
2025-03-08 22:34:17,727 - INFO - 已添加 1509 行来自 FUTU 的数据
2025-03-08 22:34:17,727 - INFO - 处理股票 DADA (20/30) 的数据...
2025-03-08 22:34:17,728 - INFO - 下载 DADA 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:18,241 - INFO - 成功获取 1195 行 DADA 的数据
2025-03-08 22:34:18,242 - INFO - 为 DADA 创建特征...
2025-03-08 22:34:18,333 - INFO - 获取市场指数数据...
2025-03-08 22:34:18,428 - INFO - 已添加 1195 行来自 DADA 的数据
2025-03-08 22:34:18,428 - INFO - 暂停2秒，避免达到API限制...
2025-03-08 22:34:20,434 - INFO - 处理股票 IQ (21/30) 的数据...
2025-03-08 22:34:20,435 - INFO - 下载 IQ 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:21,297 - INFO - 成功获取 1745 行 IQ 的数据
2025-03-08 22:34:21,297 - INFO - 为 IQ 创建特征...
2025-03-08 22:34:21,387 - INFO - 获取市场指数数据...
2025-03-08 22:34:21,483 - INFO - 已添加 1745 行来自 IQ 的数据
2025-03-08 22:34:21,484 - INFO - 处理股票 GDS (22/30) 的数据...
2025-03-08 22:34:21,484 - INFO - 下载 GDS 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:22,160 - INFO - 成功获取 2097 行 GDS 的数据
2025-03-08 22:34:22,161 - INFO - 为 GDS 创建特征...
2025-03-08 22:34:22,253 - INFO - 获取市场指数数据...
2025-03-08 22:34:22,350 - INFO - 已添加 2097 行来自 GDS 的数据
2025-03-08 22:34:22,351 - INFO - 处理股票 BGNE (23/30) 的数据...
2025-03-08 22:34:22,351 - INFO - 下载 BGNE 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:23,875 - ERROR - 
1 Failed download:
2025-03-08 22:34:23,880 - ERROR - ['BGNE']: YFTzMissingError('possibly delisted; no timezone found')
2025-03-08 22:34:23,888 - WARNING - 股票 BGNE 数据不足 (0 行)，跳过
2025-03-08 22:34:23,888 - INFO - 处理股票 EDU (24/30) 的数据...
2025-03-08 22:34:23,888 - INFO - 下载 EDU 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:24,834 - INFO - 成功获取 2514 行 EDU 的数据
2025-03-08 22:34:24,834 - INFO - 为 EDU 创建特征...
2025-03-08 22:34:24,926 - INFO - 获取市场指数数据...
2025-03-08 22:34:25,027 - INFO - 已添加 2514 行来自 EDU 的数据
2025-03-08 22:34:25,028 - INFO - 处理股票 VNET (25/30) 的数据...
2025-03-08 22:34:25,028 - INFO - 下载 VNET 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:25,726 - INFO - 成功获取 2514 行 VNET 的数据
2025-03-08 22:34:25,727 - INFO - 为 VNET 创建特征...
2025-03-08 22:34:25,818 - INFO - 获取市场指数数据...
2025-03-08 22:34:25,916 - INFO - 已添加 2514 行来自 VNET 的数据
2025-03-08 22:34:25,916 - INFO - 暂停2秒，避免达到API限制...
2025-03-08 22:34:27,921 - INFO - 处理股票 WB (26/30) 的数据...
2025-03-08 22:34:27,922 - INFO - 下载 WB 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:28,876 - INFO - 成功获取 2514 行 WB 的数据
2025-03-08 22:34:28,877 - INFO - 为 WB 创建特征...
2025-03-08 22:34:28,968 - INFO - 获取市场指数数据...
2025-03-08 22:34:29,065 - INFO - 已添加 2514 行来自 WB 的数据
2025-03-08 22:34:29,065 - INFO - 处理股票 YY (27/30) 的数据...
2025-03-08 22:34:29,065 - INFO - 下载 YY 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:29,803 - INFO - 成功获取 2514 行 YY 的数据
2025-03-08 22:34:29,804 - INFO - 为 YY 创建特征...
2025-03-08 22:34:29,897 - INFO - 获取市场指数数据...
2025-03-08 22:34:29,992 - INFO - 已添加 2514 行来自 YY 的数据
2025-03-08 22:34:29,993 - INFO - 处理股票 JOBS (28/30) 的数据...
2025-03-08 22:34:29,993 - INFO - 下载 JOBS 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:31,156 - ERROR - 
1 Failed download:
2025-03-08 22:34:31,156 - ERROR - ['JOBS']: YFTzMissingError('possibly delisted; no timezone found')
2025-03-08 22:34:31,161 - WARNING - 股票 JOBS 数据不足 (0 行)，跳过
2025-03-08 22:34:31,161 - INFO - 处理股票 MOMO (29/30) 的数据...
2025-03-08 22:34:31,161 - INFO - 下载 MOMO 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:32,035 - INFO - 成功获取 2514 行 MOMO 的数据
2025-03-08 22:34:32,035 - INFO - 为 MOMO 创建特征...
2025-03-08 22:34:32,129 - INFO - 获取市场指数数据...
2025-03-08 22:34:32,233 - INFO - 已添加 2514 行来自 MOMO 的数据
2025-03-08 22:34:32,233 - INFO - 处理股票 NOAH (30/30) 的数据...
2025-03-08 22:34:32,233 - INFO - 下载 NOAH 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:34:32,959 - INFO - 成功获取 2514 行 NOAH 的数据
2025-03-08 22:34:32,959 - INFO - 为 NOAH 创建特征...
2025-03-08 22:34:33,052 - INFO - 获取市场指数数据...
2025-03-08 22:34:33,147 - INFO - 已添加 2514 行来自 NOAH 的数据
2025-03-08 22:34:33,147 - INFO - 暂停2秒，避免达到API限制...
2025-03-08 22:34:35,152 - INFO - 总共收集了 58513 行数据
2025-03-08 22:34:35,153 - WARNING - 合并后的数据索引不是日期类型，这可能影响时间序列分析
2025-03-08 22:34:35,154 - INFO - 索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-08 22:34:35,167 - INFO - 索引示例: MultiIndex([('2015-03-11', 'BABA'),
            ('2015-03-12', 'BABA'),
            ('2015-03-13', 'BABA'),
            ('2015-03-16', 'BABA'),
            ('2015-03-17', 'BABA')],
           names=['Date', 'ticker_temp'])
2025-03-08 22:34:35,168 - INFO - 检测到MultiIndex，提取日期部分和股票标识...
2025-03-08 22:34:35,172 - INFO - 日期范围: 2015-03-11 00:00:00 到 2025-03-07 00:00:00
2025-03-08 22:34:35,177 - INFO - 不同股票数量: 28
2025-03-08 22:35:50,318 - INFO - 计算时间衰减权重...
2025-03-08 22:35:50,318 - INFO - 检测到MultiIndex，提取日期部分计算权重...
2025-03-08 22:35:50,554 - INFO - 使用MultiIndex时间衰减权重: 最大权重=3.42, 最小权重=0.06
2025-03-08 22:35:50,554 - INFO - 训练模型: RandomForest...
2025-03-08 22:36:15,426 - INFO - 训练模型: GradientBoosting...
2025-03-08 22:37:49,267 - INFO - 训练模型: ExtraTrees...
2025-03-08 22:37:53,020 - INFO - 模型使用的特征总数: 33
2025-03-08 22:37:53,020 - INFO - 前10个特征:
2025-03-08 22:37:53,021 - INFO -   1. ma10_ratio
2025-03-08 22:37:53,021 - INFO -   2. vix_trend
2025-03-08 22:37:53,021 - INFO -   3. is_china
2025-03-08 22:37:53,021 - INFO -   4. volatility_10d_change
2025-03-08 22:37:53,021 - INFO -   5. price_above_sma50
2025-03-08 22:37:53,021 - INFO -   6. ma20_ratio
2025-03-08 22:37:53,021 - INFO -   7. volume_change
2025-03-08 22:37:53,021 - INFO -   8. ma5_ratio
2025-03-08 22:37:53,021 - INFO -   9. breakout_high_20d
2025-03-08 22:37:53,022 - INFO -   10. ma100_ratio
2025-03-08 22:37:53,324 - INFO - 模型已保存到 models/master_model.pkl
2025-03-08 22:37:53,622 - INFO - 模型历史版本已保存: models/master_model_v20250308_223753.pkl
2025-03-08 22:37:53,623 - INFO - 特征列信息已保存到 models/master_model_features.txt
2025-03-08 22:37:53,633 - INFO - 样本数据已保存到 models/master_model_sample.csv
2025-03-08 22:37:53,634 - INFO - 实时交易预处理代码已保存到 models/master_model_realtime.py
2025-03-08 22:55:24,266 - INFO - 开始训练主模型...
2025-03-08 22:55:24,267 - INFO - 使用的股票: ['AAPL', 'MSFT', 'AMZN', 'GOOGL', 'META', 'NVDA', 'TSLA', 'BABA', 'JD', 'PDD', 'BIDU', 'TCEHY', 'JPM', 'V', 'BAC', 'JNJ', 'PFE', 'UNH', 'WMT', 'KO', 'MCD', 'SPY', 'QQQ', '^GSPC', '^VIX', 'XOM', 'CVX']
2025-03-08 22:55:24,268 - INFO - 处理股票 AAPL (1/27) 的数据...
2025-03-08 22:55:24,268 - INFO - 下载 AAPL 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:26,638 - INFO - 成功获取 2514 行 AAPL 的数据
2025-03-08 22:55:26,638 - INFO - 为 AAPL 创建特征...
2025-03-08 22:55:26,738 - INFO - 获取市场指数数据...
2025-03-08 22:55:27,595 - INFO - 已添加 2514 行来自 AAPL 的数据
2025-03-08 22:55:27,595 - INFO - 特征数据索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-08 22:55:27,595 - INFO - 处理股票 MSFT (2/27) 的数据...
2025-03-08 22:55:27,595 - INFO - 下载 MSFT 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:28,011 - INFO - 成功获取 2514 行 MSFT 的数据
2025-03-08 22:55:28,012 - INFO - 为 MSFT 创建特征...
2025-03-08 22:55:28,105 - INFO - 获取市场指数数据...
2025-03-08 22:55:28,199 - INFO - 已添加 2514 行来自 MSFT 的数据
2025-03-08 22:55:28,200 - INFO - 处理股票 AMZN (3/27) 的数据...
2025-03-08 22:55:28,200 - INFO - 下载 AMZN 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:28,555 - INFO - 成功获取 2514 行 AMZN 的数据
2025-03-08 22:55:28,555 - INFO - 为 AMZN 创建特征...
2025-03-08 22:55:28,648 - INFO - 获取市场指数数据...
2025-03-08 22:55:28,741 - INFO - 已添加 2514 行来自 AMZN 的数据
2025-03-08 22:55:28,741 - INFO - 处理股票 GOOGL (4/27) 的数据...
2025-03-08 22:55:28,741 - INFO - 下载 GOOGL 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:29,130 - INFO - 成功获取 2514 行 GOOGL 的数据
2025-03-08 22:55:29,131 - INFO - 为 GOOGL 创建特征...
2025-03-08 22:55:29,223 - INFO - 获取市场指数数据...
2025-03-08 22:55:29,315 - INFO - 已添加 2514 行来自 GOOGL 的数据
2025-03-08 22:55:29,315 - INFO - 处理股票 META (5/27) 的数据...
2025-03-08 22:55:29,315 - INFO - 下载 META 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:29,635 - INFO - 成功获取 2514 行 META 的数据
2025-03-08 22:55:29,635 - INFO - 为 META 创建特征...
2025-03-08 22:55:29,772 - INFO - 获取市场指数数据...
2025-03-08 22:55:29,867 - INFO - 已添加 2514 行来自 META 的数据
2025-03-08 22:55:29,867 - INFO - 暂停2秒，避免达到API限制...
2025-03-08 22:55:31,872 - INFO - 处理股票 NVDA (6/27) 的数据...
2025-03-08 22:55:31,873 - INFO - 下载 NVDA 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:32,733 - INFO - 成功获取 2514 行 NVDA 的数据
2025-03-08 22:55:32,733 - INFO - 为 NVDA 创建特征...
2025-03-08 22:55:32,826 - INFO - 获取市场指数数据...
2025-03-08 22:55:32,920 - INFO - 已添加 2514 行来自 NVDA 的数据
2025-03-08 22:55:32,921 - INFO - 处理股票 TSLA (7/27) 的数据...
2025-03-08 22:55:32,921 - INFO - 下载 TSLA 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:33,400 - INFO - 成功获取 2514 行 TSLA 的数据
2025-03-08 22:55:33,401 - INFO - 为 TSLA 创建特征...
2025-03-08 22:55:33,492 - INFO - 获取市场指数数据...
2025-03-08 22:55:33,586 - INFO - 已添加 2514 行来自 TSLA 的数据
2025-03-08 22:55:33,586 - INFO - 处理股票 BABA (8/27) 的数据...
2025-03-08 22:55:33,586 - INFO - 下载 BABA 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:34,092 - INFO - 成功获取 2514 行 BABA 的数据
2025-03-08 22:55:34,092 - INFO - 为 BABA 创建特征...
2025-03-08 22:55:34,184 - INFO - 获取市场指数数据...
2025-03-08 22:55:34,276 - INFO - 已添加 2514 行来自 BABA 的数据
2025-03-08 22:55:34,276 - INFO - 处理股票 JD (9/27) 的数据...
2025-03-08 22:55:34,276 - INFO - 下载 JD 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:34,756 - INFO - 成功获取 2514 行 JD 的数据
2025-03-08 22:55:34,757 - INFO - 为 JD 创建特征...
2025-03-08 22:55:34,849 - INFO - 获取市场指数数据...
2025-03-08 22:55:34,943 - INFO - 已添加 2514 行来自 JD 的数据
2025-03-08 22:55:34,943 - INFO - 处理股票 PDD (10/27) 的数据...
2025-03-08 22:55:34,943 - INFO - 下载 PDD 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:35,228 - INFO - 成功获取 1663 行 PDD 的数据
2025-03-08 22:55:35,228 - INFO - 为 PDD 创建特征...
2025-03-08 22:55:35,319 - INFO - 获取市场指数数据...
2025-03-08 22:55:35,625 - INFO - 已添加 1663 行来自 PDD 的数据
2025-03-08 22:55:35,626 - INFO - 暂停2秒，避免达到API限制...
2025-03-08 22:55:37,631 - INFO - 处理股票 BIDU (11/27) 的数据...
2025-03-08 22:55:37,632 - INFO - 下载 BIDU 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:38,300 - INFO - 成功获取 2514 行 BIDU 的数据
2025-03-08 22:55:38,301 - INFO - 为 BIDU 创建特征...
2025-03-08 22:55:38,393 - INFO - 获取市场指数数据...
2025-03-08 22:55:38,488 - INFO - 已添加 2514 行来自 BIDU 的数据
2025-03-08 22:55:38,488 - INFO - 处理股票 TCEHY (12/27) 的数据...
2025-03-08 22:55:38,489 - INFO - 下载 TCEHY 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:39,002 - INFO - 成功获取 2514 行 TCEHY 的数据
2025-03-08 22:55:39,003 - INFO - 为 TCEHY 创建特征...
2025-03-08 22:55:39,093 - INFO - 获取市场指数数据...
2025-03-08 22:55:39,187 - INFO - 已添加 2514 行来自 TCEHY 的数据
2025-03-08 22:55:39,187 - INFO - 处理股票 JPM (13/27) 的数据...
2025-03-08 22:55:39,187 - INFO - 下载 JPM 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:39,776 - INFO - 成功获取 2514 行 JPM 的数据
2025-03-08 22:55:39,777 - INFO - 为 JPM 创建特征...
2025-03-08 22:55:39,869 - INFO - 获取市场指数数据...
2025-03-08 22:55:39,965 - INFO - 已添加 2514 行来自 JPM 的数据
2025-03-08 22:55:39,965 - INFO - 处理股票 V (14/27) 的数据...
2025-03-08 22:55:39,965 - INFO - 下载 V 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:40,761 - INFO - 成功获取 2514 行 V 的数据
2025-03-08 22:55:40,761 - INFO - 为 V 创建特征...
2025-03-08 22:55:40,853 - INFO - 获取市场指数数据...
2025-03-08 22:55:40,946 - INFO - 已添加 2514 行来自 V 的数据
2025-03-08 22:55:40,946 - INFO - 处理股票 BAC (15/27) 的数据...
2025-03-08 22:55:40,946 - INFO - 下载 BAC 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:41,814 - INFO - 成功获取 2514 行 BAC 的数据
2025-03-08 22:55:41,814 - INFO - 为 BAC 创建特征...
2025-03-08 22:55:41,905 - INFO - 获取市场指数数据...
2025-03-08 22:55:42,009 - INFO - 已添加 2514 行来自 BAC 的数据
2025-03-08 22:55:42,009 - INFO - 暂停2秒，避免达到API限制...
2025-03-08 22:55:44,015 - INFO - 处理股票 JNJ (16/27) 的数据...
2025-03-08 22:55:44,016 - INFO - 下载 JNJ 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:44,771 - INFO - 成功获取 2514 行 JNJ 的数据
2025-03-08 22:55:44,772 - INFO - 为 JNJ 创建特征...
2025-03-08 22:55:44,863 - INFO - 获取市场指数数据...
2025-03-08 22:55:44,967 - INFO - 已添加 2514 行来自 JNJ 的数据
2025-03-08 22:55:44,968 - INFO - 处理股票 PFE (17/27) 的数据...
2025-03-08 22:55:44,968 - INFO - 下载 PFE 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:45,527 - INFO - 成功获取 2514 行 PFE 的数据
2025-03-08 22:55:45,528 - INFO - 为 PFE 创建特征...
2025-03-08 22:55:45,620 - INFO - 获取市场指数数据...
2025-03-08 22:55:45,714 - INFO - 已添加 2514 行来自 PFE 的数据
2025-03-08 22:55:45,714 - INFO - 处理股票 UNH (18/27) 的数据...
2025-03-08 22:55:45,714 - INFO - 下载 UNH 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:46,589 - INFO - 成功获取 2514 行 UNH 的数据
2025-03-08 22:55:46,590 - INFO - 为 UNH 创建特征...
2025-03-08 22:55:46,682 - INFO - 获取市场指数数据...
2025-03-08 22:55:46,778 - INFO - 已添加 2514 行来自 UNH 的数据
2025-03-08 22:55:46,779 - INFO - 处理股票 WMT (19/27) 的数据...
2025-03-08 22:55:46,779 - INFO - 下载 WMT 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:47,356 - INFO - 成功获取 2514 行 WMT 的数据
2025-03-08 22:55:47,357 - INFO - 为 WMT 创建特征...
2025-03-08 22:55:47,449 - INFO - 获取市场指数数据...
2025-03-08 22:55:47,543 - INFO - 已添加 2514 行来自 WMT 的数据
2025-03-08 22:55:47,543 - INFO - 处理股票 KO (20/27) 的数据...
2025-03-08 22:55:47,544 - INFO - 下载 KO 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:48,098 - INFO - 成功获取 2514 行 KO 的数据
2025-03-08 22:55:48,099 - INFO - 为 KO 创建特征...
2025-03-08 22:55:48,189 - INFO - 获取市场指数数据...
2025-03-08 22:55:48,283 - INFO - 已添加 2514 行来自 KO 的数据
2025-03-08 22:55:48,283 - INFO - 暂停2秒，避免达到API限制...
2025-03-08 22:55:50,289 - INFO - 处理股票 MCD (21/27) 的数据...
2025-03-08 22:55:50,290 - INFO - 下载 MCD 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:51,145 - INFO - 成功获取 2514 行 MCD 的数据
2025-03-08 22:55:51,146 - INFO - 为 MCD 创建特征...
2025-03-08 22:55:51,239 - INFO - 获取市场指数数据...
2025-03-08 22:55:51,344 - INFO - 已添加 2514 行来自 MCD 的数据
2025-03-08 22:55:51,345 - INFO - 处理股票 SPY (22/27) 的数据...
2025-03-08 22:55:51,345 - INFO - 下载 SPY 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:51,881 - INFO - 成功获取 2514 行 SPY 的数据
2025-03-08 22:55:51,881 - INFO - 为 SPY 创建特征...
2025-03-08 22:55:51,974 - INFO - 获取市场指数数据...
2025-03-08 22:55:52,069 - INFO - 已添加 2514 行来自 SPY 的数据
2025-03-08 22:55:52,070 - INFO - 处理股票 QQQ (23/27) 的数据...
2025-03-08 22:55:52,070 - INFO - 下载 QQQ 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:52,584 - INFO - 成功获取 2514 行 QQQ 的数据
2025-03-08 22:55:52,585 - INFO - 为 QQQ 创建特征...
2025-03-08 22:55:52,677 - INFO - 获取市场指数数据...
2025-03-08 22:55:52,774 - INFO - 已添加 2514 行来自 QQQ 的数据
2025-03-08 22:55:52,774 - INFO - 处理股票 ^GSPC (24/27) 的数据...
2025-03-08 22:55:52,775 - INFO - 下载 ^GSPC 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:52,812 - INFO - 成功获取 2514 行 ^GSPC 的数据
2025-03-08 22:55:52,812 - INFO - 为 ^GSPC 创建特征...
2025-03-08 22:55:52,921 - INFO - 已添加 2514 行来自 ^GSPC 的数据
2025-03-08 22:55:52,922 - INFO - 处理股票 ^VIX (25/27) 的数据...
2025-03-08 22:55:52,922 - INFO - 下载 ^VIX 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:52,967 - INFO - 成功获取 2514 行 ^VIX 的数据
2025-03-08 22:55:52,968 - INFO - 为 ^VIX 创建特征...
2025-03-08 22:55:53,076 - INFO - 已添加 2514 行来自 ^VIX 的数据
2025-03-08 22:55:53,076 - INFO - 暂停2秒，避免达到API限制...
2025-03-08 22:55:55,081 - INFO - 处理股票 XOM (26/27) 的数据...
2025-03-08 22:55:55,082 - INFO - 下载 XOM 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:55,834 - INFO - 成功获取 2514 行 XOM 的数据
2025-03-08 22:55:55,834 - INFO - 为 XOM 创建特征...
2025-03-08 22:55:55,926 - INFO - 获取市场指数数据...
2025-03-08 22:55:56,024 - INFO - 已添加 2514 行来自 XOM 的数据
2025-03-08 22:55:56,024 - INFO - 处理股票 CVX (27/27) 的数据...
2025-03-08 22:55:56,024 - INFO - 下载 CVX 的历史数据 (从 2015-03-11 到 2025-03-08)...
2025-03-08 22:55:57,278 - INFO - 成功获取 2514 行 CVX 的数据
2025-03-08 22:55:57,279 - INFO - 为 CVX 创建特征...
2025-03-08 22:55:57,371 - INFO - 获取市场指数数据...
2025-03-08 22:55:57,479 - INFO - 已添加 2514 行来自 CVX 的数据
2025-03-08 22:55:57,479 - INFO - 总共收集了 67027 行数据
2025-03-08 22:55:57,479 - WARNING - 合并后的数据索引不是日期类型，这可能影响时间序列分析
2025-03-08 22:55:57,479 - INFO - 索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-08 22:55:57,484 - INFO - 索引示例: MultiIndex([('2015-03-11', 'AAPL'),
            ('2015-03-12', 'AAPL'),
            ('2015-03-13', 'AAPL'),
            ('2015-03-16', 'AAPL'),
            ('2015-03-17', 'AAPL')],
           names=['Date', 'ticker_temp'])
2025-03-08 22:55:57,484 - INFO - 检测到MultiIndex，提取日期部分和股票标识...
2025-03-08 22:55:57,486 - INFO - 日期范围: 2015-03-11 00:00:00 到 2025-03-07 00:00:00
2025-03-08 22:55:57,490 - INFO - 不同股票数量: 27
2025-03-08 22:57:27,125 - INFO - 计算时间衰减权重...
2025-03-08 22:57:27,125 - INFO - 检测到MultiIndex，提取日期部分计算权重...
2025-03-08 22:57:27,318 - INFO - 使用MultiIndex时间衰减权重: 最大权重=4.03, 最小权重=0.07
2025-03-08 22:57:27,318 - INFO - 训练模型: RandomForest...
2025-03-08 22:57:57,057 - INFO - 训练模型: GradientBoosting...
2025-03-08 22:59:50,635 - INFO - 训练模型: ExtraTrees...
2025-03-08 22:59:54,943 - INFO - 模型使用的特征总数: 33
2025-03-08 22:59:54,943 - INFO - 前10个特征:
2025-03-08 22:59:54,943 - INFO -   1. returns_20d
2025-03-08 22:59:54,943 - INFO -   2. price_volume_ratio
2025-03-08 22:59:54,943 - INFO -   3. is_tech
2025-03-08 22:59:54,944 - INFO -   4. ma20_ratio
2025-03-08 22:59:54,944 - INFO -   5. relative_strength
2025-03-08 22:59:54,944 - INFO -   6. is_finance
2025-03-08 22:59:54,944 - INFO -   7. volatility_50d
2025-03-08 22:59:54,944 - INFO -   8. returns_1d
2025-03-08 22:59:54,944 - INFO -   9. volatility_20d
2025-03-08 22:59:54,944 - INFO -   10. is_consumer
2025-03-08 22:59:55,248 - INFO - 模型已保存到 models/master_model.pkl
2025-03-08 22:59:55,548 - INFO - 模型历史版本已保存: models/master_model_MIXED_OPTIMAL.pkl
2025-03-08 22:59:55,549 - INFO - 特征列信息已保存到 models/master_model_features.txt
2025-03-08 22:59:55,560 - INFO - 样本数据已保存到 models/master_model_sample.csv
2025-03-09 00:02:18,426 - INFO - 开始训练主模型...
2025-03-09 00:02:18,426 - INFO - 使用的股票: ['AAPL', 'MSFT', 'AMZN', 'GOOGL', 'META', 'NVDA', 'TSLA', 'BABA', 'JD', 'PDD', 'BIDU', 'TCEHY', 'JPM', 'V', 'BAC', 'JNJ', 'PFE', 'UNH', 'WMT', 'KO', 'MCD', 'SPY', 'QQQ', '^GSPC', '^VIX', 'XOM', 'CVX']
2025-03-09 00:02:18,428 - INFO - 处理股票 AAPL (1/27) 的数据...
2025-03-09 00:02:18,429 - INFO - 下载 AAPL 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:19,878 - INFO - 成功获取 2513 行 AAPL 的数据
2025-03-09 00:02:19,879 - INFO - 为 AAPL 创建特征...
2025-03-09 00:02:19,983 - INFO - 获取市场指数数据...
2025-03-09 00:02:20,596 - INFO - 已添加 2513 行来自 AAPL 的数据
2025-03-09 00:02:20,596 - INFO - 特征数据索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-09 00:02:20,596 - INFO - 处理股票 MSFT (2/27) 的数据...
2025-03-09 00:02:20,596 - INFO - 下载 MSFT 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:20,892 - INFO - 成功获取 2513 行 MSFT 的数据
2025-03-09 00:02:20,893 - INFO - 为 MSFT 创建特征...
2025-03-09 00:02:20,990 - INFO - 获取市场指数数据...
2025-03-09 00:02:21,178 - INFO - 已添加 2513 行来自 MSFT 的数据
2025-03-09 00:02:21,179 - INFO - 处理股票 AMZN (3/27) 的数据...
2025-03-09 00:02:21,179 - INFO - 下载 AMZN 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:21,483 - INFO - 成功获取 2513 行 AMZN 的数据
2025-03-09 00:02:21,484 - INFO - 为 AMZN 创建特征...
2025-03-09 00:02:21,581 - INFO - 获取市场指数数据...
2025-03-09 00:02:21,772 - INFO - 已添加 2513 行来自 AMZN 的数据
2025-03-09 00:02:21,772 - INFO - 处理股票 GOOGL (4/27) 的数据...
2025-03-09 00:02:21,772 - INFO - 下载 GOOGL 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:22,091 - INFO - 成功获取 2513 行 GOOGL 的数据
2025-03-09 00:02:22,092 - INFO - 为 GOOGL 创建特征...
2025-03-09 00:02:22,187 - INFO - 获取市场指数数据...
2025-03-09 00:02:22,374 - INFO - 已添加 2513 行来自 GOOGL 的数据
2025-03-09 00:02:22,374 - INFO - 处理股票 META (5/27) 的数据...
2025-03-09 00:02:22,374 - INFO - 下载 META 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:22,681 - INFO - 成功获取 2513 行 META 的数据
2025-03-09 00:02:22,682 - INFO - 为 META 创建特征...
2025-03-09 00:02:22,777 - INFO - 获取市场指数数据...
2025-03-09 00:02:22,958 - INFO - 已添加 2513 行来自 META 的数据
2025-03-09 00:02:22,958 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 00:02:24,963 - INFO - 处理股票 NVDA (6/27) 的数据...
2025-03-09 00:02:24,964 - INFO - 下载 NVDA 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:25,262 - INFO - 成功获取 2513 行 NVDA 的数据
2025-03-09 00:02:25,263 - INFO - 为 NVDA 创建特征...
2025-03-09 00:02:25,359 - INFO - 获取市场指数数据...
2025-03-09 00:02:25,539 - INFO - 已添加 2513 行来自 NVDA 的数据
2025-03-09 00:02:25,539 - INFO - 处理股票 TSLA (7/27) 的数据...
2025-03-09 00:02:25,539 - INFO - 下载 TSLA 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:25,803 - INFO - 成功获取 2513 行 TSLA 的数据
2025-03-09 00:02:25,804 - INFO - 为 TSLA 创建特征...
2025-03-09 00:02:25,898 - INFO - 获取市场指数数据...
2025-03-09 00:02:26,077 - INFO - 已添加 2513 行来自 TSLA 的数据
2025-03-09 00:02:26,077 - INFO - 处理股票 BABA (8/27) 的数据...
2025-03-09 00:02:26,078 - INFO - 下载 BABA 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:26,365 - INFO - 成功获取 2513 行 BABA 的数据
2025-03-09 00:02:26,366 - INFO - 为 BABA 创建特征...
2025-03-09 00:02:26,460 - INFO - 获取市场指数数据...
2025-03-09 00:02:26,631 - INFO - 已添加 2513 行来自 BABA 的数据
2025-03-09 00:02:26,631 - INFO - 处理股票 JD (9/27) 的数据...
2025-03-09 00:02:26,631 - INFO - 下载 JD 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:26,948 - INFO - 成功获取 2513 行 JD 的数据
2025-03-09 00:02:26,949 - INFO - 为 JD 创建特征...
2025-03-09 00:02:27,044 - INFO - 获取市场指数数据...
2025-03-09 00:02:27,214 - INFO - 已添加 2513 行来自 JD 的数据
2025-03-09 00:02:27,214 - INFO - 处理股票 PDD (10/27) 的数据...
2025-03-09 00:02:27,214 - INFO - 下载 PDD 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:27,496 - INFO - 成功获取 1663 行 PDD 的数据
2025-03-09 00:02:27,497 - INFO - 为 PDD 创建特征...
2025-03-09 00:02:27,589 - INFO - 获取市场指数数据...
2025-03-09 00:02:27,762 - INFO - 已添加 1663 行来自 PDD 的数据
2025-03-09 00:02:27,763 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 00:02:29,768 - INFO - 处理股票 BIDU (11/27) 的数据...
2025-03-09 00:02:29,768 - INFO - 下载 BIDU 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:29,980 - INFO - 成功获取 2513 行 BIDU 的数据
2025-03-09 00:02:29,981 - INFO - 为 BIDU 创建特征...
2025-03-09 00:02:30,076 - INFO - 获取市场指数数据...
2025-03-09 00:02:30,609 - INFO - 已添加 2513 行来自 BIDU 的数据
2025-03-09 00:02:30,610 - INFO - 处理股票 TCEHY (12/27) 的数据...
2025-03-09 00:02:30,611 - INFO - 下载 TCEHY 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:30,828 - INFO - 成功获取 2513 行 TCEHY 的数据
2025-03-09 00:02:30,829 - INFO - 为 TCEHY 创建特征...
2025-03-09 00:02:30,921 - INFO - 获取市场指数数据...
2025-03-09 00:02:31,118 - INFO - 已添加 2513 行来自 TCEHY 的数据
2025-03-09 00:02:31,118 - INFO - 处理股票 JPM (13/27) 的数据...
2025-03-09 00:02:31,119 - INFO - 下载 JPM 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:31,460 - INFO - 成功获取 2513 行 JPM 的数据
2025-03-09 00:02:31,461 - INFO - 为 JPM 创建特征...
2025-03-09 00:02:31,559 - INFO - 获取市场指数数据...
2025-03-09 00:02:31,730 - INFO - 已添加 2513 行来自 JPM 的数据
2025-03-09 00:02:31,730 - INFO - 处理股票 V (14/27) 的数据...
2025-03-09 00:02:31,730 - INFO - 下载 V 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:32,142 - INFO - 成功获取 2513 行 V 的数据
2025-03-09 00:02:32,142 - INFO - 为 V 创建特征...
2025-03-09 00:02:32,237 - INFO - 获取市场指数数据...
2025-03-09 00:02:32,431 - INFO - 已添加 2513 行来自 V 的数据
2025-03-09 00:02:32,431 - INFO - 处理股票 BAC (15/27) 的数据...
2025-03-09 00:02:32,432 - INFO - 下载 BAC 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:32,832 - INFO - 成功获取 2513 行 BAC 的数据
2025-03-09 00:02:32,832 - INFO - 为 BAC 创建特征...
2025-03-09 00:02:32,925 - INFO - 获取市场指数数据...
2025-03-09 00:02:33,095 - INFO - 已添加 2513 行来自 BAC 的数据
2025-03-09 00:02:33,095 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 00:02:35,100 - INFO - 处理股票 JNJ (16/27) 的数据...
2025-03-09 00:02:35,101 - INFO - 下载 JNJ 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:35,473 - INFO - 成功获取 2513 行 JNJ 的数据
2025-03-09 00:02:35,474 - INFO - 为 JNJ 创建特征...
2025-03-09 00:02:35,566 - INFO - 获取市场指数数据...
2025-03-09 00:02:35,741 - INFO - 已添加 2513 行来自 JNJ 的数据
2025-03-09 00:02:35,741 - INFO - 处理股票 PFE (17/27) 的数据...
2025-03-09 00:02:35,741 - INFO - 下载 PFE 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:36,090 - INFO - 成功获取 2513 行 PFE 的数据
2025-03-09 00:02:36,091 - INFO - 为 PFE 创建特征...
2025-03-09 00:02:36,184 - INFO - 获取市场指数数据...
2025-03-09 00:02:36,350 - INFO - 已添加 2513 行来自 PFE 的数据
2025-03-09 00:02:36,350 - INFO - 处理股票 UNH (18/27) 的数据...
2025-03-09 00:02:36,350 - INFO - 下载 UNH 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:36,641 - INFO - 成功获取 2513 行 UNH 的数据
2025-03-09 00:02:36,642 - INFO - 为 UNH 创建特征...
2025-03-09 00:02:36,735 - INFO - 获取市场指数数据...
2025-03-09 00:02:36,901 - INFO - 已添加 2513 行来自 UNH 的数据
2025-03-09 00:02:36,902 - INFO - 处理股票 WMT (19/27) 的数据...
2025-03-09 00:02:36,902 - INFO - 下载 WMT 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:37,233 - INFO - 成功获取 2513 行 WMT 的数据
2025-03-09 00:02:37,233 - INFO - 为 WMT 创建特征...
2025-03-09 00:02:37,324 - INFO - 获取市场指数数据...
2025-03-09 00:02:37,492 - INFO - 已添加 2513 行来自 WMT 的数据
2025-03-09 00:02:37,492 - INFO - 处理股票 KO (20/27) 的数据...
2025-03-09 00:02:37,492 - INFO - 下载 KO 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:37,927 - INFO - 成功获取 2513 行 KO 的数据
2025-03-09 00:02:37,928 - INFO - 为 KO 创建特征...
2025-03-09 00:02:38,020 - INFO - 获取市场指数数据...
2025-03-09 00:02:38,210 - INFO - 已添加 2513 行来自 KO 的数据
2025-03-09 00:02:38,210 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 00:02:40,216 - INFO - 处理股票 MCD (21/27) 的数据...
2025-03-09 00:02:40,217 - INFO - 下载 MCD 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:40,611 - INFO - 成功获取 2513 行 MCD 的数据
2025-03-09 00:02:40,612 - INFO - 为 MCD 创建特征...
2025-03-09 00:02:40,704 - INFO - 获取市场指数数据...
2025-03-09 00:02:41,421 - INFO - 已添加 2513 行来自 MCD 的数据
2025-03-09 00:02:41,422 - INFO - 处理股票 SPY (22/27) 的数据...
2025-03-09 00:02:41,422 - INFO - 下载 SPY 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:41,813 - INFO - 成功获取 2513 行 SPY 的数据
2025-03-09 00:02:41,814 - INFO - 为 SPY 创建特征...
2025-03-09 00:02:41,946 - INFO - 获取市场指数数据...
2025-03-09 00:02:42,133 - INFO - 已添加 2513 行来自 SPY 的数据
2025-03-09 00:02:42,133 - INFO - 处理股票 QQQ (23/27) 的数据...
2025-03-09 00:02:42,133 - INFO - 下载 QQQ 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:42,497 - INFO - 成功获取 2513 行 QQQ 的数据
2025-03-09 00:02:42,498 - INFO - 为 QQQ 创建特征...
2025-03-09 00:02:42,590 - INFO - 获取市场指数数据...
2025-03-09 00:02:42,818 - INFO - 已添加 2513 行来自 QQQ 的数据
2025-03-09 00:02:42,818 - INFO - 处理股票 ^GSPC (24/27) 的数据...
2025-03-09 00:02:42,818 - INFO - 下载 ^GSPC 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:42,905 - INFO - 成功获取 2513 行 ^GSPC 的数据
2025-03-09 00:02:42,906 - INFO - 为 ^GSPC 创建特征...
2025-03-09 00:02:43,016 - INFO - 已添加 2513 行来自 ^GSPC 的数据
2025-03-09 00:02:43,017 - INFO - 处理股票 ^VIX (25/27) 的数据...
2025-03-09 00:02:43,017 - INFO - 下载 ^VIX 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:43,091 - INFO - 成功获取 2513 行 ^VIX 的数据
2025-03-09 00:02:43,092 - INFO - 为 ^VIX 创建特征...
2025-03-09 00:02:43,234 - INFO - 已添加 2513 行来自 ^VIX 的数据
2025-03-09 00:02:43,234 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 00:02:45,240 - INFO - 处理股票 XOM (26/27) 的数据...
2025-03-09 00:02:45,241 - INFO - 下载 XOM 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:45,716 - INFO - 成功获取 2513 行 XOM 的数据
2025-03-09 00:02:45,717 - INFO - 为 XOM 创建特征...
2025-03-09 00:02:45,809 - INFO - 获取市场指数数据...
2025-03-09 00:02:45,991 - INFO - 已添加 2513 行来自 XOM 的数据
2025-03-09 00:02:45,992 - INFO - 处理股票 CVX (27/27) 的数据...
2025-03-09 00:02:45,992 - INFO - 下载 CVX 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:02:46,451 - INFO - 成功获取 2513 行 CVX 的数据
2025-03-09 00:02:46,452 - INFO - 为 CVX 创建特征...
2025-03-09 00:02:46,565 - INFO - 获取市场指数数据...
2025-03-09 00:02:46,736 - INFO - 已添加 2513 行来自 CVX 的数据
2025-03-09 00:02:46,736 - INFO - 总共收集了 67001 行数据
2025-03-09 00:02:46,736 - WARNING - 合并后的数据索引不是日期类型，这可能影响时间序列分析
2025-03-09 00:02:46,736 - INFO - 索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-09 00:02:46,741 - INFO - 索引示例: MultiIndex([('2015-03-12', 'AAPL'),
            ('2015-03-13', 'AAPL'),
            ('2015-03-16', 'AAPL'),
            ('2015-03-17', 'AAPL'),
            ('2015-03-18', 'AAPL')],
           names=['Date', 'ticker_temp'])
2025-03-09 00:02:46,741 - INFO - 检测到MultiIndex，提取日期部分和股票标识...
2025-03-09 00:02:46,743 - INFO - 日期范围: 2015-03-12 00:00:00 到 2025-03-07 00:00:00
2025-03-09 00:02:46,747 - INFO - 不同股票数量: 27
2025-03-09 00:04:16,799 - INFO - 计算时间衰减权重...
2025-03-09 00:04:16,799 - INFO - 检测到MultiIndex，提取日期部分计算权重...
2025-03-09 00:04:16,981 - INFO - 使用MultiIndex时间衰减权重: 最大权重=4.03, 最小权重=0.07
2025-03-09 00:04:16,982 - INFO - 训练模型: RandomForest...
2025-03-09 00:04:46,309 - INFO - 训练模型: GradientBoosting...
2025-03-09 00:06:39,628 - INFO - 训练模型: ExtraTrees...
2025-03-09 00:06:44,198 - INFO - 模型使用的特征总数: 33
2025-03-09 00:06:44,198 - INFO - 前10个特征:
2025-03-09 00:06:44,198 - INFO -   1. ma20_ratio
2025-03-09 00:06:44,199 - INFO -   2. volume_change
2025-03-09 00:06:44,199 - INFO -   3. returns_1d
2025-03-09 00:06:44,199 - INFO -   4. macd_above_signal
2025-03-09 00:06:44,199 - INFO -   5. ma200_ratio
2025-03-09 00:06:44,199 - INFO -   6. returns_10d
2025-03-09 00:06:44,199 - INFO -   7. price_volume_ratio
2025-03-09 00:06:44,199 - INFO -   8. ma50_ratio
2025-03-09 00:06:44,200 - INFO -   9. price_above_sma50
2025-03-09 00:06:44,200 - INFO -   10. volatility_10d_change
2025-03-09 00:06:44,507 - INFO - 模型已保存到 models/master_model.pkl
2025-03-09 00:06:44,809 - INFO - 模型历史版本已保存: models/master_model_MIXED_OPTIMAL.pkl
2025-03-09 00:06:44,810 - INFO - 特征列信息已保存到 models/master_model_features.txt
2025-03-09 00:06:44,819 - INFO - 样本数据已保存到 models/master_model_sample.csv
2025-03-09 00:12:09,010 - INFO - 开始训练主模型...
2025-03-09 00:12:09,011 - INFO - 使用的股票: ['AAPL', 'MSFT', 'AMZN', 'GOOGL', 'META', 'NVDA', 'TSLA', 'BABA', 'JD', 'PDD', 'BIDU', 'TCEHY', 'JPM', 'V', 'BAC', 'JNJ', 'PFE', 'UNH', 'WMT', 'KO', 'MCD', 'SPY', 'QQQ', '^GSPC', '^VIX', 'XOM', 'CVX']
2025-03-09 00:12:09,013 - INFO - 处理股票 AAPL (1/27) 的数据...
2025-03-09 00:12:09,013 - INFO - 下载 AAPL 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:09,879 - INFO - 成功获取 2513 行 AAPL 的数据
2025-03-09 00:12:09,880 - INFO - 为 AAPL 创建特征...
2025-03-09 00:12:09,979 - INFO - 获取市场指数数据...
2025-03-09 00:12:10,662 - INFO - 已添加 2513 行来自 AAPL 的数据
2025-03-09 00:12:10,662 - INFO - 特征数据索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-09 00:12:10,662 - INFO - 处理股票 MSFT (2/27) 的数据...
2025-03-09 00:12:10,662 - INFO - 下载 MSFT 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:10,922 - INFO - 成功获取 2513 行 MSFT 的数据
2025-03-09 00:12:10,923 - INFO - 为 MSFT 创建特征...
2025-03-09 00:12:11,016 - INFO - 获取市场指数数据...
2025-03-09 00:12:11,271 - INFO - 已添加 2513 行来自 MSFT 的数据
2025-03-09 00:12:11,271 - INFO - 处理股票 AMZN (3/27) 的数据...
2025-03-09 00:12:11,271 - INFO - 下载 AMZN 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:11,629 - INFO - 成功获取 2513 行 AMZN 的数据
2025-03-09 00:12:11,630 - INFO - 为 AMZN 创建特征...
2025-03-09 00:12:11,723 - INFO - 获取市场指数数据...
2025-03-09 00:12:11,900 - INFO - 已添加 2513 行来自 AMZN 的数据
2025-03-09 00:12:11,900 - INFO - 处理股票 GOOGL (4/27) 的数据...
2025-03-09 00:12:11,900 - INFO - 下载 GOOGL 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:12,241 - INFO - 成功获取 2513 行 GOOGL 的数据
2025-03-09 00:12:12,241 - INFO - 为 GOOGL 创建特征...
2025-03-09 00:12:12,337 - INFO - 获取市场指数数据...
2025-03-09 00:12:12,505 - INFO - 已添加 2513 行来自 GOOGL 的数据
2025-03-09 00:12:12,505 - INFO - 处理股票 META (5/27) 的数据...
2025-03-09 00:12:12,505 - INFO - 下载 META 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:12,731 - INFO - 成功获取 2513 行 META 的数据
2025-03-09 00:12:12,731 - INFO - 为 META 创建特征...
2025-03-09 00:12:12,824 - INFO - 获取市场指数数据...
2025-03-09 00:12:12,994 - INFO - 已添加 2513 行来自 META 的数据
2025-03-09 00:12:12,994 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 00:12:14,995 - INFO - 处理股票 NVDA (6/27) 的数据...
2025-03-09 00:12:14,995 - INFO - 下载 NVDA 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:15,414 - INFO - 成功获取 2513 行 NVDA 的数据
2025-03-09 00:12:15,414 - INFO - 为 NVDA 创建特征...
2025-03-09 00:12:15,507 - INFO - 获取市场指数数据...
2025-03-09 00:12:15,693 - INFO - 已添加 2513 行来自 NVDA 的数据
2025-03-09 00:12:15,693 - INFO - 处理股票 TSLA (7/27) 的数据...
2025-03-09 00:12:15,693 - INFO - 下载 TSLA 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:15,927 - INFO - 成功获取 2513 行 TSLA 的数据
2025-03-09 00:12:15,928 - INFO - 为 TSLA 创建特征...
2025-03-09 00:12:16,020 - INFO - 获取市场指数数据...
2025-03-09 00:12:16,188 - INFO - 已添加 2513 行来自 TSLA 的数据
2025-03-09 00:12:16,189 - INFO - 处理股票 BABA (8/27) 的数据...
2025-03-09 00:12:16,189 - INFO - 下载 BABA 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:16,516 - INFO - 成功获取 2513 行 BABA 的数据
2025-03-09 00:12:16,517 - INFO - 为 BABA 创建特征...
2025-03-09 00:12:16,609 - INFO - 获取市场指数数据...
2025-03-09 00:12:16,800 - INFO - 已添加 2513 行来自 BABA 的数据
2025-03-09 00:12:16,801 - INFO - 处理股票 JD (9/27) 的数据...
2025-03-09 00:12:16,801 - INFO - 下载 JD 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:17,126 - INFO - 成功获取 2513 行 JD 的数据
2025-03-09 00:12:17,126 - INFO - 为 JD 创建特征...
2025-03-09 00:12:17,219 - INFO - 获取市场指数数据...
2025-03-09 00:12:17,408 - INFO - 已添加 2513 行来自 JD 的数据
2025-03-09 00:12:17,408 - INFO - 处理股票 PDD (10/27) 的数据...
2025-03-09 00:12:17,409 - INFO - 下载 PDD 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:17,622 - INFO - 成功获取 1663 行 PDD 的数据
2025-03-09 00:12:17,623 - INFO - 为 PDD 创建特征...
2025-03-09 00:12:17,714 - INFO - 获取市场指数数据...
2025-03-09 00:12:17,909 - INFO - 已添加 1663 行来自 PDD 的数据
2025-03-09 00:12:17,909 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 00:12:19,914 - INFO - 处理股票 BIDU (11/27) 的数据...
2025-03-09 00:12:19,915 - INFO - 下载 BIDU 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:20,242 - INFO - 成功获取 2513 行 BIDU 的数据
2025-03-09 00:12:20,242 - INFO - 为 BIDU 创建特征...
2025-03-09 00:12:20,335 - INFO - 获取市场指数数据...
2025-03-09 00:12:20,878 - INFO - 已添加 2513 行来自 BIDU 的数据
2025-03-09 00:12:20,878 - INFO - 处理股票 TCEHY (12/27) 的数据...
2025-03-09 00:12:20,878 - INFO - 下载 TCEHY 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:21,227 - INFO - 成功获取 2513 行 TCEHY 的数据
2025-03-09 00:12:21,228 - INFO - 为 TCEHY 创建特征...
2025-03-09 00:12:21,319 - INFO - 获取市场指数数据...
2025-03-09 00:12:21,514 - INFO - 已添加 2513 行来自 TCEHY 的数据
2025-03-09 00:12:21,514 - INFO - 处理股票 JPM (13/27) 的数据...
2025-03-09 00:12:21,514 - INFO - 下载 JPM 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:21,884 - INFO - 成功获取 2513 行 JPM 的数据
2025-03-09 00:12:21,885 - INFO - 为 JPM 创建特征...
2025-03-09 00:12:21,977 - INFO - 获取市场指数数据...
2025-03-09 00:12:22,157 - INFO - 已添加 2513 行来自 JPM 的数据
2025-03-09 00:12:22,157 - INFO - 处理股票 V (14/27) 的数据...
2025-03-09 00:12:22,158 - INFO - 下载 V 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:22,448 - INFO - 成功获取 2513 行 V 的数据
2025-03-09 00:12:22,449 - INFO - 为 V 创建特征...
2025-03-09 00:12:22,540 - INFO - 获取市场指数数据...
2025-03-09 00:12:22,728 - INFO - 已添加 2513 行来自 V 的数据
2025-03-09 00:12:22,728 - INFO - 处理股票 BAC (15/27) 的数据...
2025-03-09 00:12:22,729 - INFO - 下载 BAC 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:23,077 - INFO - 成功获取 2513 行 BAC 的数据
2025-03-09 00:12:23,078 - INFO - 为 BAC 创建特征...
2025-03-09 00:12:23,170 - INFO - 获取市场指数数据...
2025-03-09 00:12:23,353 - INFO - 已添加 2513 行来自 BAC 的数据
2025-03-09 00:12:23,353 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 00:12:25,359 - INFO - 处理股票 JNJ (16/27) 的数据...
2025-03-09 00:12:25,360 - INFO - 下载 JNJ 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:25,767 - INFO - 成功获取 2513 行 JNJ 的数据
2025-03-09 00:12:25,768 - INFO - 为 JNJ 创建特征...
2025-03-09 00:12:25,860 - INFO - 获取市场指数数据...
2025-03-09 00:12:26,039 - INFO - 已添加 2513 行来自 JNJ 的数据
2025-03-09 00:12:26,039 - INFO - 处理股票 PFE (17/27) 的数据...
2025-03-09 00:12:26,039 - INFO - 下载 PFE 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:26,401 - INFO - 成功获取 2513 行 PFE 的数据
2025-03-09 00:12:26,401 - INFO - 为 PFE 创建特征...
2025-03-09 00:12:26,493 - INFO - 获取市场指数数据...
2025-03-09 00:12:26,679 - INFO - 已添加 2513 行来自 PFE 的数据
2025-03-09 00:12:26,679 - INFO - 处理股票 UNH (18/27) 的数据...
2025-03-09 00:12:26,679 - INFO - 下载 UNH 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:26,947 - INFO - 成功获取 2513 行 UNH 的数据
2025-03-09 00:12:26,947 - INFO - 为 UNH 创建特征...
2025-03-09 00:12:27,039 - INFO - 获取市场指数数据...
2025-03-09 00:12:27,232 - INFO - 已添加 2513 行来自 UNH 的数据
2025-03-09 00:12:27,232 - INFO - 处理股票 WMT (19/27) 的数据...
2025-03-09 00:12:27,232 - INFO - 下载 WMT 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:27,661 - INFO - 成功获取 2513 行 WMT 的数据
2025-03-09 00:12:27,662 - INFO - 为 WMT 创建特征...
2025-03-09 00:12:27,754 - INFO - 获取市场指数数据...
2025-03-09 00:12:27,933 - INFO - 已添加 2513 行来自 WMT 的数据
2025-03-09 00:12:27,933 - INFO - 处理股票 KO (20/27) 的数据...
2025-03-09 00:12:27,933 - INFO - 下载 KO 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:28,292 - INFO - 成功获取 2513 行 KO 的数据
2025-03-09 00:12:28,293 - INFO - 为 KO 创建特征...
2025-03-09 00:12:28,385 - INFO - 获取市场指数数据...
2025-03-09 00:12:28,567 - INFO - 已添加 2513 行来自 KO 的数据
2025-03-09 00:12:28,568 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 00:12:30,573 - INFO - 处理股票 MCD (21/27) 的数据...
2025-03-09 00:12:30,574 - INFO - 下载 MCD 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:30,984 - INFO - 成功获取 2513 行 MCD 的数据
2025-03-09 00:12:30,985 - INFO - 为 MCD 创建特征...
2025-03-09 00:12:31,077 - INFO - 获取市场指数数据...
2025-03-09 00:12:31,718 - INFO - 已添加 2513 行来自 MCD 的数据
2025-03-09 00:12:31,719 - INFO - 处理股票 SPY (22/27) 的数据...
2025-03-09 00:12:31,719 - INFO - 下载 SPY 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:32,015 - INFO - 成功获取 2513 行 SPY 的数据
2025-03-09 00:12:32,016 - INFO - 为 SPY 创建特征...
2025-03-09 00:12:32,108 - INFO - 获取市场指数数据...
2025-03-09 00:12:32,309 - INFO - 已添加 2513 行来自 SPY 的数据
2025-03-09 00:12:32,309 - INFO - 处理股票 QQQ (23/27) 的数据...
2025-03-09 00:12:32,309 - INFO - 下载 QQQ 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:32,624 - INFO - 成功获取 2513 行 QQQ 的数据
2025-03-09 00:12:32,625 - INFO - 为 QQQ 创建特征...
2025-03-09 00:12:32,716 - INFO - 获取市场指数数据...
2025-03-09 00:12:32,901 - INFO - 已添加 2513 行来自 QQQ 的数据
2025-03-09 00:12:32,901 - INFO - 处理股票 ^GSPC (24/27) 的数据...
2025-03-09 00:12:32,901 - INFO - 下载 ^GSPC 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:32,980 - INFO - 成功获取 2513 行 ^GSPC 的数据
2025-03-09 00:12:32,981 - INFO - 为 ^GSPC 创建特征...
2025-03-09 00:12:33,088 - INFO - 已添加 2513 行来自 ^GSPC 的数据
2025-03-09 00:12:33,088 - INFO - 处理股票 ^VIX (25/27) 的数据...
2025-03-09 00:12:33,089 - INFO - 下载 ^VIX 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:33,162 - INFO - 成功获取 2513 行 ^VIX 的数据
2025-03-09 00:12:33,163 - INFO - 为 ^VIX 创建特征...
2025-03-09 00:12:33,270 - INFO - 已添加 2513 行来自 ^VIX 的数据
2025-03-09 00:12:33,271 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 00:12:35,276 - INFO - 处理股票 XOM (26/27) 的数据...
2025-03-09 00:12:35,277 - INFO - 下载 XOM 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:35,677 - INFO - 成功获取 2513 行 XOM 的数据
2025-03-09 00:12:35,678 - INFO - 为 XOM 创建特征...
2025-03-09 00:12:35,769 - INFO - 获取市场指数数据...
2025-03-09 00:12:35,964 - INFO - 已添加 2513 行来自 XOM 的数据
2025-03-09 00:12:35,964 - INFO - 处理股票 CVX (27/27) 的数据...
2025-03-09 00:12:35,965 - INFO - 下载 CVX 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 00:12:36,441 - INFO - 成功获取 2513 行 CVX 的数据
2025-03-09 00:12:36,442 - INFO - 为 CVX 创建特征...
2025-03-09 00:12:36,533 - INFO - 获取市场指数数据...
2025-03-09 00:12:36,717 - INFO - 已添加 2513 行来自 CVX 的数据
2025-03-09 00:12:36,718 - INFO - 总共收集了 67001 行数据
2025-03-09 00:12:36,718 - WARNING - 合并后的数据索引不是日期类型，这可能影响时间序列分析
2025-03-09 00:12:36,718 - INFO - 索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-09 00:12:36,723 - INFO - 索引示例: MultiIndex([('2015-03-12', 'AAPL'),
            ('2015-03-13', 'AAPL'),
            ('2015-03-16', 'AAPL'),
            ('2015-03-17', 'AAPL'),
            ('2015-03-18', 'AAPL')],
           names=['Date', 'ticker_temp'])
2025-03-09 00:12:36,723 - INFO - 检测到MultiIndex，提取日期部分和股票标识...
2025-03-09 00:12:36,725 - INFO - 日期范围: 2015-03-12 00:00:00 到 2025-03-07 00:00:00
2025-03-09 00:12:36,728 - INFO - 不同股票数量: 27
2025-03-09 00:14:06,910 - INFO - 计算时间衰减权重...
2025-03-09 00:14:06,910 - INFO - 检测到MultiIndex，提取日期部分计算权重...
2025-03-09 00:14:07,085 - INFO - 使用MultiIndex时间衰减权重: 最大权重=4.03, 最小权重=0.07
2025-03-09 00:14:07,086 - INFO - 训练模型: RandomForest...
2025-03-09 00:14:37,604 - INFO - 训练模型: GradientBoosting...
2025-03-09 00:16:30,625 - INFO - 训练模型: ExtraTrees...
2025-03-09 00:16:34,948 - INFO - 模型使用的特征总数: 33
2025-03-09 00:16:34,949 - INFO - 前10个特征:
2025-03-09 00:16:34,949 - INFO -   1. returns_5d
2025-03-09 00:16:34,949 - INFO -   2. volatility_10d
2025-03-09 00:16:34,949 - INFO -   3. volatility_5d
2025-03-09 00:16:34,949 - INFO -   4. ma50_ratio
2025-03-09 00:16:34,949 - INFO -   5. vix_ma20
2025-03-09 00:16:34,949 - INFO -   6. volatility_20d_change
2025-03-09 00:16:34,949 - INFO -   7. volume_change
2025-03-09 00:16:34,949 - INFO -   8. vix
2025-03-09 00:16:34,950 - INFO -   9. ma5_ratio
2025-03-09 00:16:34,950 - INFO -   10. returns_10d
2025-03-09 00:16:35,253 - INFO - 模型已保存到 models/master_model.pkl
2025-03-09 00:16:35,551 - INFO - 模型历史版本已保存: models/master_model_MIXED_OPTIMAL.pkl
2025-03-09 00:16:35,553 - INFO - 特征列信息已保存到 models/master_model_features.txt
2025-03-09 00:16:35,561 - INFO - 样本数据已保存到 models/master_model_sample.csv
2025-03-09 01:23:11,584 - INFO - 开始训练主模型...
2025-03-09 01:23:11,584 - INFO - 使用的股票: ['BABA', 'JD', 'PDD', 'BIDU', 'TCEHY', 'NIO', 'NTES', 'BILI', 'TAL', 'YUMC', 'LI', 'XPEV', 'TME', 'HTHT', 'ZTO', 'VIPS', 'ATHM', 'BEKE', 'FUTU', 'DADA', 'IQ', 'GDS', 'BGNE', 'EDU', 'VNET', 'WB', 'YY', 'JOBS', 'MOMO', 'NOAH']
2025-03-09 01:23:11,585 - INFO - 处理股票 BABA (1/30) 的数据...
2025-03-09 01:23:11,585 - INFO - 下载 BABA 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:12,115 - INFO - 成功获取 2513 行 BABA 的数据
2025-03-09 01:23:12,116 - INFO - 为 BABA 创建特征...
2025-03-09 01:23:12,238 - INFO - 获取市场指数数据...
2025-03-09 01:23:13,032 - INFO - 已添加 2513 行来自 BABA 的数据
2025-03-09 01:23:13,033 - INFO - 特征数据索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-09 01:23:13,033 - INFO - 处理股票 JD (2/30) 的数据...
2025-03-09 01:23:13,033 - INFO - 下载 JD 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:13,458 - INFO - 成功获取 2513 行 JD 的数据
2025-03-09 01:23:13,459 - INFO - 为 JD 创建特征...
2025-03-09 01:23:13,554 - INFO - 获取市场指数数据...
2025-03-09 01:23:14,093 - INFO - 已添加 2513 行来自 JD 的数据
2025-03-09 01:23:14,093 - INFO - 处理股票 PDD (3/30) 的数据...
2025-03-09 01:23:14,093 - INFO - 下载 PDD 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:14,383 - INFO - 成功获取 1663 行 PDD 的数据
2025-03-09 01:23:14,384 - INFO - 为 PDD 创建特征...
2025-03-09 01:23:14,477 - INFO - 获取市场指数数据...
2025-03-09 01:23:15,011 - INFO - 已添加 1663 行来自 PDD 的数据
2025-03-09 01:23:15,011 - INFO - 处理股票 BIDU (4/30) 的数据...
2025-03-09 01:23:15,012 - INFO - 下载 BIDU 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:15,383 - INFO - 成功获取 2513 行 BIDU 的数据
2025-03-09 01:23:15,384 - INFO - 为 BIDU 创建特征...
2025-03-09 01:23:15,477 - INFO - 获取市场指数数据...
2025-03-09 01:23:16,024 - INFO - 已添加 2513 行来自 BIDU 的数据
2025-03-09 01:23:16,024 - INFO - 处理股票 TCEHY (5/30) 的数据...
2025-03-09 01:23:16,024 - INFO - 下载 TCEHY 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:16,380 - INFO - 成功获取 2513 行 TCEHY 的数据
2025-03-09 01:23:16,381 - INFO - 为 TCEHY 创建特征...
2025-03-09 01:23:16,483 - INFO - 获取市场指数数据...
2025-03-09 01:23:17,006 - INFO - 已添加 2513 行来自 TCEHY 的数据
2025-03-09 01:23:17,007 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 01:23:19,012 - INFO - 处理股票 NIO (6/30) 的数据...
2025-03-09 01:23:19,013 - INFO - 下载 NIO 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:19,635 - INFO - 成功获取 1630 行 NIO 的数据
2025-03-09 01:23:19,636 - INFO - 为 NIO 创建特征...
2025-03-09 01:23:19,729 - INFO - 获取市场指数数据...
2025-03-09 01:23:20,419 - INFO - 已添加 1630 行来自 NIO 的数据
2025-03-09 01:23:20,420 - INFO - 处理股票 NTES (7/30) 的数据...
2025-03-09 01:23:20,420 - INFO - 下载 NTES 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:20,826 - INFO - 成功获取 2513 行 NTES 的数据
2025-03-09 01:23:20,827 - INFO - 为 NTES 创建特征...
2025-03-09 01:23:20,922 - INFO - 获取市场指数数据...
2025-03-09 01:23:21,453 - INFO - 已添加 2513 行来自 NTES 的数据
2025-03-09 01:23:21,453 - INFO - 处理股票 BILI (8/30) 的数据...
2025-03-09 01:23:21,453 - INFO - 下载 BILI 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:21,748 - INFO - 成功获取 1746 行 BILI 的数据
2025-03-09 01:23:21,749 - INFO - 为 BILI 创建特征...
2025-03-09 01:23:21,842 - INFO - 获取市场指数数据...
2025-03-09 01:23:22,461 - INFO - 已添加 1746 行来自 BILI 的数据
2025-03-09 01:23:22,461 - INFO - 处理股票 TAL (9/30) 的数据...
2025-03-09 01:23:22,461 - INFO - 下载 TAL 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:22,892 - INFO - 成功获取 2513 行 TAL 的数据
2025-03-09 01:23:22,893 - INFO - 为 TAL 创建特征...
2025-03-09 01:23:22,985 - INFO - 获取市场指数数据...
2025-03-09 01:23:23,795 - INFO - 已添加 2513 行来自 TAL 的数据
2025-03-09 01:23:23,796 - INFO - 处理股票 YUMC (10/30) 的数据...
2025-03-09 01:23:23,796 - INFO - 下载 YUMC 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:24,211 - INFO - 成功获取 2109 行 YUMC 的数据
2025-03-09 01:23:24,212 - INFO - 为 YUMC 创建特征...
2025-03-09 01:23:24,305 - INFO - 获取市场指数数据...
2025-03-09 01:23:24,863 - INFO - 已添加 2109 行来自 YUMC 的数据
2025-03-09 01:23:24,863 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 01:23:26,869 - INFO - 处理股票 LI (11/30) 的数据...
2025-03-09 01:23:26,870 - INFO - 下载 LI 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:27,348 - INFO - 成功获取 1157 行 LI 的数据
2025-03-09 01:23:27,349 - INFO - 为 LI 创建特征...
2025-03-09 01:23:27,441 - INFO - 获取市场指数数据...
2025-03-09 01:23:28,149 - INFO - 已添加 1157 行来自 LI 的数据
2025-03-09 01:23:28,149 - INFO - 处理股票 XPEV (12/30) 的数据...
2025-03-09 01:23:28,149 - INFO - 下载 XPEV 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:28,435 - INFO - 成功获取 1137 行 XPEV 的数据
2025-03-09 01:23:28,436 - INFO - 为 XPEV 创建特征...
2025-03-09 01:23:28,527 - INFO - 获取市场指数数据...
2025-03-09 01:23:29,079 - INFO - 已添加 1137 行来自 XPEV 的数据
2025-03-09 01:23:29,079 - INFO - 处理股票 TME (13/30) 的数据...
2025-03-09 01:23:29,079 - INFO - 下载 TME 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:29,425 - INFO - 成功获取 1567 行 TME 的数据
2025-03-09 01:23:29,426 - INFO - 为 TME 创建特征...
2025-03-09 01:23:29,517 - INFO - 获取市场指数数据...
2025-03-09 01:23:30,064 - INFO - 已添加 1567 行来自 TME 的数据
2025-03-09 01:23:30,064 - INFO - 处理股票 HTHT (14/30) 的数据...
2025-03-09 01:23:30,064 - INFO - 下载 HTHT 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:30,412 - INFO - 成功获取 2513 行 HTHT 的数据
2025-03-09 01:23:30,413 - INFO - 为 HTHT 创建特征...
2025-03-09 01:23:30,504 - INFO - 获取市场指数数据...
2025-03-09 01:23:31,056 - INFO - 已添加 2513 行来自 HTHT 的数据
2025-03-09 01:23:31,056 - INFO - 处理股票 ZTO (15/30) 的数据...
2025-03-09 01:23:31,056 - INFO - 下载 ZTO 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:31,397 - INFO - 成功获取 2101 行 ZTO 的数据
2025-03-09 01:23:31,398 - INFO - 为 ZTO 创建特征...
2025-03-09 01:23:31,490 - INFO - 获取市场指数数据...
2025-03-09 01:23:32,072 - INFO - 已添加 2101 行来自 ZTO 的数据
2025-03-09 01:23:32,073 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 01:23:34,078 - INFO - 处理股票 VIPS (16/30) 的数据...
2025-03-09 01:23:34,079 - INFO - 下载 VIPS 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:34,741 - INFO - 成功获取 2513 行 VIPS 的数据
2025-03-09 01:23:34,742 - INFO - 为 VIPS 创建特征...
2025-03-09 01:23:34,835 - INFO - 获取市场指数数据...
2025-03-09 01:23:35,635 - INFO - 已添加 2513 行来自 VIPS 的数据
2025-03-09 01:23:35,635 - INFO - 处理股票 ATHM (17/30) 的数据...
2025-03-09 01:23:35,635 - INFO - 下载 ATHM 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:35,989 - INFO - 成功获取 2513 行 ATHM 的数据
2025-03-09 01:23:35,990 - INFO - 为 ATHM 创建特征...
2025-03-09 01:23:36,081 - INFO - 获取市场指数数据...
2025-03-09 01:23:36,620 - INFO - 已添加 2513 行来自 ATHM 的数据
2025-03-09 01:23:36,620 - INFO - 处理股票 BEKE (18/30) 的数据...
2025-03-09 01:23:36,620 - INFO - 下载 BEKE 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:36,987 - INFO - 成功获取 1147 行 BEKE 的数据
2025-03-09 01:23:36,987 - INFO - 为 BEKE 创建特征...
2025-03-09 01:23:37,077 - INFO - 获取市场指数数据...
2025-03-09 01:23:37,622 - INFO - 已添加 1147 行来自 BEKE 的数据
2025-03-09 01:23:37,622 - INFO - 处理股票 FUTU (19/30) 的数据...
2025-03-09 01:23:37,622 - INFO - 下载 FUTU 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:37,916 - INFO - 成功获取 1509 行 FUTU 的数据
2025-03-09 01:23:37,917 - INFO - 为 FUTU 创建特征...
2025-03-09 01:23:38,007 - INFO - 获取市场指数数据...
2025-03-09 01:23:38,534 - INFO - 已添加 1509 行来自 FUTU 的数据
2025-03-09 01:23:38,535 - INFO - 处理股票 DADA (20/30) 的数据...
2025-03-09 01:23:38,535 - INFO - 下载 DADA 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:38,829 - INFO - 成功获取 1195 行 DADA 的数据
2025-03-09 01:23:38,830 - INFO - 为 DADA 创建特征...
2025-03-09 01:23:38,921 - INFO - 获取市场指数数据...
2025-03-09 01:23:39,479 - INFO - 已添加 1195 行来自 DADA 的数据
2025-03-09 01:23:39,479 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 01:23:41,485 - INFO - 处理股票 IQ (21/30) 的数据...
2025-03-09 01:23:41,486 - INFO - 下载 IQ 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:42,129 - INFO - 成功获取 1745 行 IQ 的数据
2025-03-09 01:23:42,130 - INFO - 为 IQ 创建特征...
2025-03-09 01:23:42,223 - INFO - 获取市场指数数据...
2025-03-09 01:23:42,954 - INFO - 已添加 1745 行来自 IQ 的数据
2025-03-09 01:23:42,954 - INFO - 处理股票 GDS (22/30) 的数据...
2025-03-09 01:23:42,954 - INFO - 下载 GDS 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:43,236 - INFO - 成功获取 2097 行 GDS 的数据
2025-03-09 01:23:43,237 - INFO - 为 GDS 创建特征...
2025-03-09 01:23:43,328 - INFO - 获取市场指数数据...
2025-03-09 01:23:43,870 - INFO - 已添加 2097 行来自 GDS 的数据
2025-03-09 01:23:43,870 - INFO - 处理股票 BGNE (23/30) 的数据...
2025-03-09 01:23:43,870 - INFO - 下载 BGNE 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:46,267 - ERROR - 
1 Failed download:
2025-03-09 01:23:46,267 - ERROR - ['BGNE']: YFTzMissingError('possibly delisted; no timezone found')
2025-03-09 01:23:46,276 - WARNING - 股票 BGNE 数据不足 (0 行)，跳过
2025-03-09 01:23:46,280 - INFO - 处理股票 EDU (24/30) 的数据...
2025-03-09 01:23:46,280 - INFO - 下载 EDU 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:46,969 - INFO - 成功获取 2513 行 EDU 的数据
2025-03-09 01:23:46,970 - INFO - 为 EDU 创建特征...
2025-03-09 01:23:47,062 - INFO - 获取市场指数数据...
2025-03-09 01:23:47,843 - INFO - 已添加 2513 行来自 EDU 的数据
2025-03-09 01:23:47,844 - INFO - 处理股票 VNET (25/30) 的数据...
2025-03-09 01:23:47,844 - INFO - 下载 VNET 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:48,139 - INFO - 成功获取 2513 行 VNET 的数据
2025-03-09 01:23:48,140 - INFO - 为 VNET 创建特征...
2025-03-09 01:23:48,232 - INFO - 获取市场指数数据...
2025-03-09 01:23:48,776 - INFO - 已添加 2513 行来自 VNET 的数据
2025-03-09 01:23:48,777 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 01:23:50,782 - INFO - 处理股票 WB (26/30) 的数据...
2025-03-09 01:23:50,783 - INFO - 下载 WB 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:51,437 - INFO - 成功获取 2513 行 WB 的数据
2025-03-09 01:23:51,438 - INFO - 为 WB 创建特征...
2025-03-09 01:23:51,530 - INFO - 获取市场指数数据...
2025-03-09 01:23:52,304 - INFO - 已添加 2513 行来自 WB 的数据
2025-03-09 01:23:52,305 - INFO - 处理股票 YY (27/30) 的数据...
2025-03-09 01:23:52,305 - INFO - 下载 YY 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:52,805 - INFO - 成功获取 2513 行 YY 的数据
2025-03-09 01:23:52,805 - INFO - 为 YY 创建特征...
2025-03-09 01:23:52,902 - INFO - 获取市场指数数据...
2025-03-09 01:23:53,451 - INFO - 已添加 2513 行来自 YY 的数据
2025-03-09 01:23:53,451 - INFO - 处理股票 JOBS (28/30) 的数据...
2025-03-09 01:23:53,451 - INFO - 下载 JOBS 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:54,862 - ERROR - 
1 Failed download:
2025-03-09 01:23:54,862 - ERROR - ['JOBS']: YFTzMissingError('possibly delisted; no timezone found')
2025-03-09 01:23:54,871 - WARNING - 股票 JOBS 数据不足 (0 行)，跳过
2025-03-09 01:23:54,871 - INFO - 处理股票 MOMO (29/30) 的数据...
2025-03-09 01:23:54,871 - INFO - 下载 MOMO 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:55,549 - INFO - 成功获取 2513 行 MOMO 的数据
2025-03-09 01:23:55,549 - INFO - 为 MOMO 创建特征...
2025-03-09 01:23:55,640 - INFO - 获取市场指数数据...
2025-03-09 01:23:56,180 - INFO - 已添加 2513 行来自 MOMO 的数据
2025-03-09 01:23:56,180 - INFO - 处理股票 NOAH (30/30) 的数据...
2025-03-09 01:23:56,180 - INFO - 下载 NOAH 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:23:56,542 - INFO - 成功获取 2513 行 NOAH 的数据
2025-03-09 01:23:56,542 - INFO - 为 NOAH 创建特征...
2025-03-09 01:23:56,634 - INFO - 获取市场指数数据...
2025-03-09 01:23:57,198 - INFO - 已添加 2513 行来自 NOAH 的数据
2025-03-09 01:23:57,198 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 01:23:59,204 - INFO - 总共收集了 58498 行数据
2025-03-09 01:23:59,205 - WARNING - 合并后的数据索引不是日期类型，这可能影响时间序列分析
2025-03-09 01:23:59,205 - INFO - 索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-09 01:23:59,218 - INFO - 索引示例: MultiIndex([('2015-03-12', 'BABA'),
            ('2015-03-13', 'BABA'),
            ('2015-03-16', 'BABA'),
            ('2015-03-17', 'BABA'),
            ('2015-03-18', 'BABA')],
           names=['Date', 'ticker_temp'])
2025-03-09 01:23:59,218 - INFO - 检测到MultiIndex，提取日期部分和股票标识...
2025-03-09 01:23:59,221 - INFO - 日期范围: 2015-03-12 00:00:00 到 2025-03-07 00:00:00
2025-03-09 01:23:59,227 - INFO - 不同股票数量: 28
2025-03-09 01:25:13,941 - INFO - 计算时间衰减权重...
2025-03-09 01:25:13,942 - INFO - 检测到MultiIndex，提取日期部分计算权重...
2025-03-09 01:25:14,108 - INFO - 使用MultiIndex时间衰减权重: 最大权重=3.42, 最小权重=0.06
2025-03-09 01:25:14,109 - INFO - 训练模型: RandomForest...
2025-03-09 01:25:40,039 - INFO - 训练模型: GradientBoosting...
2025-03-09 01:27:14,578 - INFO - 训练模型: ExtraTrees...
2025-03-09 01:27:18,495 - INFO - 模型使用的特征总数: 33
2025-03-09 01:27:18,495 - INFO - 前10个特征:
2025-03-09 01:27:18,495 - INFO -   1. vix_trend
2025-03-09 01:27:18,495 - INFO -   2. returns_20d
2025-03-09 01:27:18,495 - INFO -   3. volume_ma20_ratio
2025-03-09 01:27:18,495 - INFO -   4. price_above_sma20
2025-03-09 01:27:18,495 - INFO -   5. volume_change
2025-03-09 01:27:18,496 - INFO -   6. market_trend
2025-03-09 01:27:18,496 - INFO -   7. vix
2025-03-09 01:27:18,496 - INFO -   8. ma10_ratio
2025-03-09 01:27:18,496 - INFO -   9. price_volume_ratio
2025-03-09 01:27:18,496 - INFO -   10. breakout_high_20d
2025-03-09 01:27:18,807 - INFO - 模型已保存到 models/master_model.pkl
2025-03-09 01:27:19,110 - INFO - 模型历史版本已保存: models/master_model_CHINA.pkl
2025-03-09 01:27:19,111 - INFO - 特征列信息已保存到 models/master_model_features.txt
2025-03-09 01:27:19,124 - INFO - 样本数据已保存到 models/master_model_sample.csv
2025-03-09 01:36:42,770 - INFO - 开始训练主模型...
2025-03-09 01:36:42,771 - INFO - 使用的股票: ['BABA', 'JD', 'PDD', 'BIDU', 'TCEHY', 'NIO', 'NTES', 'BILI', 'TAL', 'YUMC', 'LI', 'XPEV', 'TME', 'HTHT', 'ZTO', 'VIPS', 'ATHM', 'BEKE', 'FUTU', 'DADA', 'IQ', 'GDS', 'BGNE', 'EDU', 'VNET', 'WB', 'YY', 'JOBS', 'MOMO', 'NOAH']
2025-03-09 01:36:42,771 - INFO - 处理股票 BABA (1/30) 的数据...
2025-03-09 01:36:42,771 - INFO - 下载 BABA 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:42,962 - INFO - 成功获取 2513 行 BABA 的数据
2025-03-09 01:36:42,962 - INFO - 为 BABA 创建特征...
2025-03-09 01:36:43,061 - INFO - 获取市场指数数据...
2025-03-09 01:36:43,428 - INFO - 已添加 2513 行来自 BABA 的数据
2025-03-09 01:36:43,428 - INFO - 特征数据索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-09 01:36:43,428 - INFO - 处理股票 JD (2/30) 的数据...
2025-03-09 01:36:43,429 - INFO - 下载 JD 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:43,627 - INFO - 成功获取 2513 行 JD 的数据
2025-03-09 01:36:43,627 - INFO - 为 JD 创建特征...
2025-03-09 01:36:43,721 - INFO - 获取市场指数数据...
2025-03-09 01:36:43,889 - INFO - 已添加 2513 行来自 JD 的数据
2025-03-09 01:36:43,889 - INFO - 处理股票 PDD (3/30) 的数据...
2025-03-09 01:36:43,889 - INFO - 下载 PDD 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:44,118 - INFO - 成功获取 1663 行 PDD 的数据
2025-03-09 01:36:44,119 - INFO - 为 PDD 创建特征...
2025-03-09 01:36:44,211 - INFO - 获取市场指数数据...
2025-03-09 01:36:44,381 - INFO - 已添加 1663 行来自 PDD 的数据
2025-03-09 01:36:44,381 - INFO - 处理股票 BIDU (4/30) 的数据...
2025-03-09 01:36:44,381 - INFO - 下载 BIDU 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:44,580 - INFO - 成功获取 2513 行 BIDU 的数据
2025-03-09 01:36:44,581 - INFO - 为 BIDU 创建特征...
2025-03-09 01:36:44,678 - INFO - 获取市场指数数据...
2025-03-09 01:36:44,858 - INFO - 已添加 2513 行来自 BIDU 的数据
2025-03-09 01:36:44,859 - INFO - 处理股票 TCEHY (5/30) 的数据...
2025-03-09 01:36:44,859 - INFO - 下载 TCEHY 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:45,199 - INFO - 成功获取 2513 行 TCEHY 的数据
2025-03-09 01:36:45,200 - INFO - 为 TCEHY 创建特征...
2025-03-09 01:36:45,293 - INFO - 获取市场指数数据...
2025-03-09 01:36:45,462 - INFO - 已添加 2513 行来自 TCEHY 的数据
2025-03-09 01:36:45,462 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 01:36:47,468 - INFO - 处理股票 NIO (6/30) 的数据...
2025-03-09 01:36:47,469 - INFO - 下载 NIO 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:47,731 - INFO - 成功获取 1630 行 NIO 的数据
2025-03-09 01:36:47,732 - INFO - 为 NIO 创建特征...
2025-03-09 01:36:47,825 - INFO - 获取市场指数数据...
2025-03-09 01:36:47,994 - INFO - 已添加 1630 行来自 NIO 的数据
2025-03-09 01:36:47,994 - INFO - 处理股票 NTES (7/30) 的数据...
2025-03-09 01:36:47,995 - INFO - 下载 NTES 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:48,272 - INFO - 成功获取 2513 行 NTES 的数据
2025-03-09 01:36:48,273 - INFO - 为 NTES 创建特征...
2025-03-09 01:36:48,364 - INFO - 获取市场指数数据...
2025-03-09 01:36:48,540 - INFO - 已添加 2513 行来自 NTES 的数据
2025-03-09 01:36:48,540 - INFO - 处理股票 BILI (8/30) 的数据...
2025-03-09 01:36:48,540 - INFO - 下载 BILI 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:48,733 - INFO - 成功获取 1746 行 BILI 的数据
2025-03-09 01:36:48,733 - INFO - 为 BILI 创建特征...
2025-03-09 01:36:48,826 - INFO - 获取市场指数数据...
2025-03-09 01:36:49,051 - INFO - 已添加 1746 行来自 BILI 的数据
2025-03-09 01:36:49,051 - INFO - 处理股票 TAL (9/30) 的数据...
2025-03-09 01:36:49,051 - INFO - 下载 TAL 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:49,316 - INFO - 成功获取 2513 行 TAL 的数据
2025-03-09 01:36:49,317 - INFO - 为 TAL 创建特征...
2025-03-09 01:36:49,408 - INFO - 获取市场指数数据...
2025-03-09 01:36:49,591 - INFO - 已添加 2513 行来自 TAL 的数据
2025-03-09 01:36:49,591 - INFO - 处理股票 YUMC (10/30) 的数据...
2025-03-09 01:36:49,591 - INFO - 下载 YUMC 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:49,923 - INFO - 成功获取 2109 行 YUMC 的数据
2025-03-09 01:36:49,924 - INFO - 为 YUMC 创建特征...
2025-03-09 01:36:50,017 - INFO - 获取市场指数数据...
2025-03-09 01:36:50,189 - INFO - 已添加 2109 行来自 YUMC 的数据
2025-03-09 01:36:50,189 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 01:36:52,195 - INFO - 处理股票 LI (11/30) 的数据...
2025-03-09 01:36:52,196 - INFO - 下载 LI 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:52,466 - INFO - 成功获取 1157 行 LI 的数据
2025-03-09 01:36:52,467 - INFO - 为 LI 创建特征...
2025-03-09 01:36:52,558 - INFO - 获取市场指数数据...
2025-03-09 01:36:52,727 - INFO - 已添加 1157 行来自 LI 的数据
2025-03-09 01:36:52,727 - INFO - 处理股票 XPEV (12/30) 的数据...
2025-03-09 01:36:52,727 - INFO - 下载 XPEV 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:52,950 - INFO - 成功获取 1137 行 XPEV 的数据
2025-03-09 01:36:52,951 - INFO - 为 XPEV 创建特征...
2025-03-09 01:36:53,042 - INFO - 获取市场指数数据...
2025-03-09 01:36:53,222 - INFO - 已添加 1137 行来自 XPEV 的数据
2025-03-09 01:36:53,222 - INFO - 处理股票 TME (13/30) 的数据...
2025-03-09 01:36:53,222 - INFO - 下载 TME 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:53,529 - INFO - 成功获取 1567 行 TME 的数据
2025-03-09 01:36:53,530 - INFO - 为 TME 创建特征...
2025-03-09 01:36:53,620 - INFO - 获取市场指数数据...
2025-03-09 01:36:54,097 - INFO - 已添加 1567 行来自 TME 的数据
2025-03-09 01:36:54,097 - INFO - 处理股票 HTHT (14/30) 的数据...
2025-03-09 01:36:54,097 - INFO - 下载 HTHT 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:54,448 - INFO - 成功获取 2513 行 HTHT 的数据
2025-03-09 01:36:54,449 - INFO - 为 HTHT 创建特征...
2025-03-09 01:36:54,541 - INFO - 获取市场指数数据...
2025-03-09 01:36:54,838 - INFO - 已添加 2513 行来自 HTHT 的数据
2025-03-09 01:36:54,838 - INFO - 处理股票 ZTO (15/30) 的数据...
2025-03-09 01:36:54,838 - INFO - 下载 ZTO 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:55,075 - INFO - 成功获取 2101 行 ZTO 的数据
2025-03-09 01:36:55,075 - INFO - 为 ZTO 创建特征...
2025-03-09 01:36:55,167 - INFO - 获取市场指数数据...
2025-03-09 01:36:55,440 - INFO - 已添加 2101 行来自 ZTO 的数据
2025-03-09 01:36:55,440 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 01:36:57,445 - INFO - 处理股票 VIPS (16/30) 的数据...
2025-03-09 01:36:57,447 - INFO - 下载 VIPS 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:57,783 - INFO - 成功获取 2513 行 VIPS 的数据
2025-03-09 01:36:57,784 - INFO - 为 VIPS 创建特征...
2025-03-09 01:36:57,876 - INFO - 获取市场指数数据...
2025-03-09 01:36:58,055 - INFO - 已添加 2513 行来自 VIPS 的数据
2025-03-09 01:36:58,055 - INFO - 处理股票 ATHM (17/30) 的数据...
2025-03-09 01:36:58,055 - INFO - 下载 ATHM 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:58,433 - INFO - 成功获取 2513 行 ATHM 的数据
2025-03-09 01:36:58,434 - INFO - 为 ATHM 创建特征...
2025-03-09 01:36:58,526 - INFO - 获取市场指数数据...
2025-03-09 01:36:58,708 - INFO - 已添加 2513 行来自 ATHM 的数据
2025-03-09 01:36:58,708 - INFO - 处理股票 BEKE (18/30) 的数据...
2025-03-09 01:36:58,708 - INFO - 下载 BEKE 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:58,893 - INFO - 成功获取 1147 行 BEKE 的数据
2025-03-09 01:36:58,894 - INFO - 为 BEKE 创建特征...
2025-03-09 01:36:58,983 - INFO - 获取市场指数数据...
2025-03-09 01:36:59,150 - INFO - 已添加 1147 行来自 BEKE 的数据
2025-03-09 01:36:59,151 - INFO - 处理股票 FUTU (19/30) 的数据...
2025-03-09 01:36:59,151 - INFO - 下载 FUTU 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:59,416 - INFO - 成功获取 1509 行 FUTU 的数据
2025-03-09 01:36:59,417 - INFO - 为 FUTU 创建特征...
2025-03-09 01:36:59,507 - INFO - 获取市场指数数据...
2025-03-09 01:36:59,676 - INFO - 已添加 1509 行来自 FUTU 的数据
2025-03-09 01:36:59,676 - INFO - 处理股票 DADA (20/30) 的数据...
2025-03-09 01:36:59,676 - INFO - 下载 DADA 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:36:59,836 - INFO - 成功获取 1195 行 DADA 的数据
2025-03-09 01:36:59,837 - INFO - 为 DADA 创建特征...
2025-03-09 01:36:59,927 - INFO - 获取市场指数数据...
2025-03-09 01:37:00,114 - INFO - 已添加 1195 行来自 DADA 的数据
2025-03-09 01:37:00,114 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 01:37:02,119 - INFO - 处理股票 IQ (21/30) 的数据...
2025-03-09 01:37:02,120 - INFO - 下载 IQ 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:37:02,323 - INFO - 成功获取 1745 行 IQ 的数据
2025-03-09 01:37:02,323 - INFO - 为 IQ 创建特征...
2025-03-09 01:37:02,415 - INFO - 获取市场指数数据...
2025-03-09 01:37:02,606 - INFO - 已添加 1745 行来自 IQ 的数据
2025-03-09 01:37:02,606 - INFO - 处理股票 GDS (22/30) 的数据...
2025-03-09 01:37:02,606 - INFO - 下载 GDS 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:37:02,880 - INFO - 成功获取 2097 行 GDS 的数据
2025-03-09 01:37:02,881 - INFO - 为 GDS 创建特征...
2025-03-09 01:37:02,972 - INFO - 获取市场指数数据...
2025-03-09 01:37:03,145 - INFO - 已添加 2097 行来自 GDS 的数据
2025-03-09 01:37:03,145 - INFO - 处理股票 BGNE (23/30) 的数据...
2025-03-09 01:37:03,145 - INFO - 下载 BGNE 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:37:04,606 - ERROR - 
1 Failed download:
2025-03-09 01:37:04,606 - ERROR - ['BGNE']: YFTzMissingError('possibly delisted; no timezone found')
2025-03-09 01:37:04,611 - WARNING - 股票 BGNE 数据不足 (0 行)，跳过
2025-03-09 01:37:04,611 - INFO - 处理股票 EDU (24/30) 的数据...
2025-03-09 01:37:04,611 - INFO - 下载 EDU 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:37:04,970 - INFO - 成功获取 2513 行 EDU 的数据
2025-03-09 01:37:04,971 - INFO - 为 EDU 创建特征...
2025-03-09 01:37:05,071 - INFO - 获取市场指数数据...
2025-03-09 01:37:05,434 - INFO - 已添加 2513 行来自 EDU 的数据
2025-03-09 01:37:05,434 - INFO - 处理股票 VNET (25/30) 的数据...
2025-03-09 01:37:05,434 - INFO - 下载 VNET 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:37:05,623 - INFO - 成功获取 2513 行 VNET 的数据
2025-03-09 01:37:05,623 - INFO - 为 VNET 创建特征...
2025-03-09 01:37:05,715 - INFO - 获取市场指数数据...
2025-03-09 01:37:06,127 - INFO - 已添加 2513 行来自 VNET 的数据
2025-03-09 01:37:06,127 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 01:37:08,132 - INFO - 处理股票 WB (26/30) 的数据...
2025-03-09 01:37:08,132 - INFO - 下载 WB 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:37:08,377 - INFO - 成功获取 2513 行 WB 的数据
2025-03-09 01:37:08,378 - INFO - 为 WB 创建特征...
2025-03-09 01:37:08,469 - INFO - 获取市场指数数据...
2025-03-09 01:37:08,644 - INFO - 已添加 2513 行来自 WB 的数据
2025-03-09 01:37:08,644 - INFO - 处理股票 YY (27/30) 的数据...
2025-03-09 01:37:08,644 - INFO - 下载 YY 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:37:08,886 - INFO - 成功获取 2513 行 YY 的数据
2025-03-09 01:37:08,887 - INFO - 为 YY 创建特征...
2025-03-09 01:37:08,979 - INFO - 获取市场指数数据...
2025-03-09 01:37:09,150 - INFO - 已添加 2513 行来自 YY 的数据
2025-03-09 01:37:09,151 - INFO - 处理股票 JOBS (28/30) 的数据...
2025-03-09 01:37:09,151 - INFO - 下载 JOBS 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:37:10,313 - ERROR - 
1 Failed download:
2025-03-09 01:37:10,313 - ERROR - ['JOBS']: YFTzMissingError('possibly delisted; no timezone found')
2025-03-09 01:37:10,322 - WARNING - 股票 JOBS 数据不足 (0 行)，跳过
2025-03-09 01:37:10,323 - INFO - 处理股票 MOMO (29/30) 的数据...
2025-03-09 01:37:10,323 - INFO - 下载 MOMO 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:37:10,539 - INFO - 成功获取 2513 行 MOMO 的数据
2025-03-09 01:37:10,540 - INFO - 为 MOMO 创建特征...
2025-03-09 01:37:10,631 - INFO - 获取市场指数数据...
2025-03-09 01:37:10,801 - INFO - 已添加 2513 行来自 MOMO 的数据
2025-03-09 01:37:10,802 - INFO - 处理股票 NOAH (30/30) 的数据...
2025-03-09 01:37:10,802 - INFO - 下载 NOAH 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 01:37:11,030 - INFO - 成功获取 2513 行 NOAH 的数据
2025-03-09 01:37:11,031 - INFO - 为 NOAH 创建特征...
2025-03-09 01:37:11,124 - INFO - 获取市场指数数据...
2025-03-09 01:37:11,295 - INFO - 已添加 2513 行来自 NOAH 的数据
2025-03-09 01:37:11,296 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 01:37:13,301 - INFO - 总共收集了 58498 行数据
2025-03-09 01:37:13,301 - WARNING - 合并后的数据索引不是日期类型，这可能影响时间序列分析
2025-03-09 01:37:13,301 - INFO - 索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-09 01:37:13,306 - INFO - 索引示例: MultiIndex([('2015-03-12', 'BABA'),
            ('2015-03-13', 'BABA'),
            ('2015-03-16', 'BABA'),
            ('2015-03-17', 'BABA'),
            ('2015-03-18', 'BABA')],
           names=['Date', 'ticker_temp'])
2025-03-09 01:37:13,307 - INFO - 检测到MultiIndex，提取日期部分和股票标识...
2025-03-09 01:37:13,309 - INFO - 日期范围: 2015-03-12 00:00:00 到 2025-03-07 00:00:00
2025-03-09 01:37:13,312 - INFO - 不同股票数量: 28
2025-03-09 01:38:27,932 - INFO - 计算时间衰减权重...
2025-03-09 01:38:27,933 - INFO - 检测到MultiIndex，提取日期部分计算权重...
2025-03-09 01:38:28,082 - INFO - 使用MultiIndex时间衰减权重: 最大权重=3.42, 最小权重=0.06
2025-03-09 01:38:28,083 - INFO - 训练模型: RandomForest...
2025-03-09 01:38:53,088 - INFO - 训练模型: GradientBoosting...
2025-03-09 01:40:30,861 - INFO - 训练模型: ExtraTrees...
2025-03-09 01:40:34,937 - INFO - 模型使用的特征总数: 33
2025-03-09 01:40:34,937 - INFO - 前10个特征:
2025-03-09 01:40:34,938 - INFO -   1. volatility_10d_change
2025-03-09 01:40:34,938 - INFO -   2. volume_change
2025-03-09 01:40:34,938 - INFO -   3. market_trend
2025-03-09 01:40:34,938 - INFO -   4. volatility_20d
2025-03-09 01:40:34,938 - INFO -   5. ma50_ratio
2025-03-09 01:40:34,938 - INFO -   6. ma200_ratio
2025-03-09 01:40:34,938 - INFO -   7. ma10_ratio
2025-03-09 01:40:34,938 - INFO -   8. relative_strength
2025-03-09 01:40:34,938 - INFO -   9. returns_10d
2025-03-09 01:40:34,939 - INFO -   10. vix_trend
2025-03-09 01:40:35,258 - INFO - 模型已保存到 models/master_model.pkl
2025-03-09 01:40:35,562 - INFO - 模型历史版本已保存: models/master_model_CHINA.pkl
2025-03-09 01:40:35,563 - INFO - 特征列信息已保存到 models/master_model_features.txt
2025-03-09 01:40:35,576 - INFO - 样本数据已保存到 models/master_model_sample.csv
2025-03-09 02:14:15,785 - INFO - 开始训练主模型...
2025-03-09 02:14:15,785 - INFO - 使用的股票: ['AAPL', 'MSFT', 'AMZN', 'GOOGL', 'META', 'NVDA', 'AVGO', 'CSCO', 'ADBE', 'CRM', 'INTC', 'AMD', 'IBM', 'QCOM', 'TXN', 'TSLA', 'NFLX', 'PYPL', 'ORCL', 'AMAT', 'MU', 'KLAC', 'NOW', 'LRCX', 'SNPS', 'CDNS', 'INTU', 'ADI', 'UBER', 'ABNB']
2025-03-09 02:14:15,786 - INFO - 处理股票 AAPL (1/30) 的数据...
2025-03-09 02:14:15,786 - INFO - 下载 AAPL 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:16,213 - INFO - 成功获取 2513 行 AAPL 的数据
2025-03-09 02:14:16,213 - INFO - 为 AAPL 创建特征...
2025-03-09 02:14:16,312 - INFO - 获取市场指数数据...
2025-03-09 02:14:16,927 - INFO - 已添加 2513 行来自 AAPL 的数据
2025-03-09 02:14:16,927 - INFO - 特征数据索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-09 02:14:16,927 - INFO - 处理股票 MSFT (2/30) 的数据...
2025-03-09 02:14:16,927 - INFO - 下载 MSFT 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:17,202 - INFO - 成功获取 2513 行 MSFT 的数据
2025-03-09 02:14:17,203 - INFO - 为 MSFT 创建特征...
2025-03-09 02:14:17,297 - INFO - 获取市场指数数据...
2025-03-09 02:14:17,475 - INFO - 已添加 2513 行来自 MSFT 的数据
2025-03-09 02:14:17,476 - INFO - 处理股票 AMZN (3/30) 的数据...
2025-03-09 02:14:17,476 - INFO - 下载 AMZN 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:17,819 - INFO - 成功获取 2513 行 AMZN 的数据
2025-03-09 02:14:17,820 - INFO - 为 AMZN 创建特征...
2025-03-09 02:14:17,913 - INFO - 获取市场指数数据...
2025-03-09 02:14:18,090 - INFO - 已添加 2513 行来自 AMZN 的数据
2025-03-09 02:14:18,091 - INFO - 处理股票 GOOGL (4/30) 的数据...
2025-03-09 02:14:18,091 - INFO - 下载 GOOGL 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:18,329 - INFO - 成功获取 2513 行 GOOGL 的数据
2025-03-09 02:14:18,329 - INFO - 为 GOOGL 创建特征...
2025-03-09 02:14:18,423 - INFO - 获取市场指数数据...
2025-03-09 02:14:18,593 - INFO - 已添加 2513 行来自 GOOGL 的数据
2025-03-09 02:14:18,594 - INFO - 处理股票 META (5/30) 的数据...
2025-03-09 02:14:18,594 - INFO - 下载 META 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:18,897 - INFO - 成功获取 2513 行 META 的数据
2025-03-09 02:14:18,898 - INFO - 为 META 创建特征...
2025-03-09 02:14:18,990 - INFO - 获取市场指数数据...
2025-03-09 02:14:19,168 - INFO - 已添加 2513 行来自 META 的数据
2025-03-09 02:14:19,168 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 02:14:21,173 - INFO - 处理股票 NVDA (6/30) 的数据...
2025-03-09 02:14:21,174 - INFO - 下载 NVDA 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:21,453 - INFO - 成功获取 2513 行 NVDA 的数据
2025-03-09 02:14:21,454 - INFO - 为 NVDA 创建特征...
2025-03-09 02:14:21,547 - INFO - 获取市场指数数据...
2025-03-09 02:14:21,722 - INFO - 已添加 2513 行来自 NVDA 的数据
2025-03-09 02:14:21,723 - INFO - 处理股票 AVGO (7/30) 的数据...
2025-03-09 02:14:21,723 - INFO - 下载 AVGO 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:21,996 - INFO - 成功获取 2513 行 AVGO 的数据
2025-03-09 02:14:21,996 - INFO - 为 AVGO 创建特征...
2025-03-09 02:14:22,089 - INFO - 获取市场指数数据...
2025-03-09 02:14:22,276 - INFO - 已添加 2513 行来自 AVGO 的数据
2025-03-09 02:14:22,276 - INFO - 处理股票 CSCO (8/30) 的数据...
2025-03-09 02:14:22,277 - INFO - 下载 CSCO 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:22,514 - INFO - 成功获取 2513 行 CSCO 的数据
2025-03-09 02:14:22,515 - INFO - 为 CSCO 创建特征...
2025-03-09 02:14:22,608 - INFO - 获取市场指数数据...
2025-03-09 02:14:22,786 - INFO - 已添加 2513 行来自 CSCO 的数据
2025-03-09 02:14:22,786 - INFO - 处理股票 ADBE (9/30) 的数据...
2025-03-09 02:14:22,786 - INFO - 下载 ADBE 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:23,022 - INFO - 成功获取 2513 行 ADBE 的数据
2025-03-09 02:14:23,023 - INFO - 为 ADBE 创建特征...
2025-03-09 02:14:23,127 - INFO - 获取市场指数数据...
2025-03-09 02:14:23,304 - INFO - 已添加 2513 行来自 ADBE 的数据
2025-03-09 02:14:23,304 - INFO - 处理股票 CRM (10/30) 的数据...
2025-03-09 02:14:23,304 - INFO - 下载 CRM 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:23,555 - INFO - 成功获取 2513 行 CRM 的数据
2025-03-09 02:14:23,555 - INFO - 为 CRM 创建特征...
2025-03-09 02:14:23,647 - INFO - 获取市场指数数据...
2025-03-09 02:14:23,824 - INFO - 已添加 2513 行来自 CRM 的数据
2025-03-09 02:14:23,824 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 02:14:25,829 - INFO - 处理股票 INTC (11/30) 的数据...
2025-03-09 02:14:25,830 - INFO - 下载 INTC 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:26,068 - INFO - 成功获取 2513 行 INTC 的数据
2025-03-09 02:14:26,069 - INFO - 为 INTC 创建特征...
2025-03-09 02:14:26,162 - INFO - 获取市场指数数据...
2025-03-09 02:14:26,353 - INFO - 已添加 2513 行来自 INTC 的数据
2025-03-09 02:14:26,353 - INFO - 处理股票 AMD (12/30) 的数据...
2025-03-09 02:14:26,353 - INFO - 下载 AMD 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:26,665 - INFO - 成功获取 2513 行 AMD 的数据
2025-03-09 02:14:26,666 - INFO - 为 AMD 创建特征...
2025-03-09 02:14:26,758 - INFO - 获取市场指数数据...
2025-03-09 02:14:26,921 - INFO - 已添加 2513 行来自 AMD 的数据
2025-03-09 02:14:26,922 - INFO - 处理股票 IBM (13/30) 的数据...
2025-03-09 02:14:26,922 - INFO - 下载 IBM 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:27,255 - INFO - 成功获取 2513 行 IBM 的数据
2025-03-09 02:14:27,256 - INFO - 为 IBM 创建特征...
2025-03-09 02:14:27,347 - INFO - 获取市场指数数据...
2025-03-09 02:14:27,701 - INFO - 已添加 2513 行来自 IBM 的数据
2025-03-09 02:14:27,701 - INFO - 处理股票 QCOM (14/30) 的数据...
2025-03-09 02:14:27,701 - INFO - 下载 QCOM 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:27,881 - INFO - 成功获取 2513 行 QCOM 的数据
2025-03-09 02:14:27,881 - INFO - 为 QCOM 创建特征...
2025-03-09 02:14:27,973 - INFO - 获取市场指数数据...
2025-03-09 02:14:28,152 - INFO - 已添加 2513 行来自 QCOM 的数据
2025-03-09 02:14:28,152 - INFO - 处理股票 TXN (15/30) 的数据...
2025-03-09 02:14:28,152 - INFO - 下载 TXN 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:28,431 - INFO - 成功获取 2513 行 TXN 的数据
2025-03-09 02:14:28,431 - INFO - 为 TXN 创建特征...
2025-03-09 02:14:28,523 - INFO - 获取市场指数数据...
2025-03-09 02:14:28,692 - INFO - 已添加 2513 行来自 TXN 的数据
2025-03-09 02:14:28,692 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 02:14:30,698 - INFO - 处理股票 TSLA (16/30) 的数据...
2025-03-09 02:14:30,699 - INFO - 下载 TSLA 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:30,951 - INFO - 成功获取 2513 行 TSLA 的数据
2025-03-09 02:14:30,952 - INFO - 为 TSLA 创建特征...
2025-03-09 02:14:31,046 - INFO - 获取市场指数数据...
2025-03-09 02:14:31,227 - INFO - 已添加 2513 行来自 TSLA 的数据
2025-03-09 02:14:31,227 - INFO - 处理股票 NFLX (17/30) 的数据...
2025-03-09 02:14:31,227 - INFO - 下载 NFLX 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:31,430 - INFO - 成功获取 2513 行 NFLX 的数据
2025-03-09 02:14:31,430 - INFO - 为 NFLX 创建特征...
2025-03-09 02:14:31,523 - INFO - 获取市场指数数据...
2025-03-09 02:14:31,700 - INFO - 已添加 2513 行来自 NFLX 的数据
2025-03-09 02:14:31,700 - INFO - 处理股票 PYPL (18/30) 的数据...
2025-03-09 02:14:31,700 - INFO - 下载 PYPL 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:32,027 - INFO - 成功获取 2434 行 PYPL 的数据
2025-03-09 02:14:32,028 - INFO - 为 PYPL 创建特征...
2025-03-09 02:14:32,120 - INFO - 获取市场指数数据...
2025-03-09 02:14:32,300 - INFO - 已添加 2434 行来自 PYPL 的数据
2025-03-09 02:14:32,300 - INFO - 处理股票 ORCL (19/30) 的数据...
2025-03-09 02:14:32,300 - INFO - 下载 ORCL 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:32,655 - INFO - 成功获取 2513 行 ORCL 的数据
2025-03-09 02:14:32,656 - INFO - 为 ORCL 创建特征...
2025-03-09 02:14:32,747 - INFO - 获取市场指数数据...
2025-03-09 02:14:32,916 - INFO - 已添加 2513 行来自 ORCL 的数据
2025-03-09 02:14:32,916 - INFO - 处理股票 AMAT (20/30) 的数据...
2025-03-09 02:14:32,917 - INFO - 下载 AMAT 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:33,380 - INFO - 成功获取 2513 行 AMAT 的数据
2025-03-09 02:14:33,381 - INFO - 为 AMAT 创建特征...
2025-03-09 02:14:33,473 - INFO - 获取市场指数数据...
2025-03-09 02:14:33,644 - INFO - 已添加 2513 行来自 AMAT 的数据
2025-03-09 02:14:33,644 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 02:14:35,646 - INFO - 处理股票 MU (21/30) 的数据...
2025-03-09 02:14:35,648 - INFO - 下载 MU 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:36,002 - INFO - 成功获取 2513 行 MU 的数据
2025-03-09 02:14:36,003 - INFO - 为 MU 创建特征...
2025-03-09 02:14:36,095 - INFO - 获取市场指数数据...
2025-03-09 02:14:36,267 - INFO - 已添加 2513 行来自 MU 的数据
2025-03-09 02:14:36,267 - INFO - 处理股票 KLAC (22/30) 的数据...
2025-03-09 02:14:36,268 - INFO - 下载 KLAC 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:36,586 - INFO - 成功获取 2513 行 KLAC 的数据
2025-03-09 02:14:36,587 - INFO - 为 KLAC 创建特征...
2025-03-09 02:14:36,678 - INFO - 获取市场指数数据...
2025-03-09 02:14:36,878 - INFO - 已添加 2513 行来自 KLAC 的数据
2025-03-09 02:14:36,878 - INFO - 处理股票 NOW (23/30) 的数据...
2025-03-09 02:14:36,878 - INFO - 下载 NOW 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:37,252 - INFO - 成功获取 2513 行 NOW 的数据
2025-03-09 02:14:37,253 - INFO - 为 NOW 创建特征...
2025-03-09 02:14:37,344 - INFO - 获取市场指数数据...
2025-03-09 02:14:37,515 - INFO - 已添加 2513 行来自 NOW 的数据
2025-03-09 02:14:37,516 - INFO - 处理股票 LRCX (24/30) 的数据...
2025-03-09 02:14:37,516 - INFO - 下载 LRCX 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:37,994 - INFO - 成功获取 2513 行 LRCX 的数据
2025-03-09 02:14:37,994 - INFO - 为 LRCX 创建特征...
2025-03-09 02:14:38,086 - INFO - 获取市场指数数据...
2025-03-09 02:14:38,457 - INFO - 已添加 2513 行来自 LRCX 的数据
2025-03-09 02:14:38,457 - INFO - 处理股票 SNPS (25/30) 的数据...
2025-03-09 02:14:38,457 - INFO - 下载 SNPS 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:38,769 - INFO - 成功获取 2513 行 SNPS 的数据
2025-03-09 02:14:38,770 - INFO - 为 SNPS 创建特征...
2025-03-09 02:14:38,863 - INFO - 获取市场指数数据...
2025-03-09 02:14:39,054 - INFO - 已添加 2513 行来自 SNPS 的数据
2025-03-09 02:14:39,054 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 02:14:41,060 - INFO - 处理股票 CDNS (26/30) 的数据...
2025-03-09 02:14:41,060 - INFO - 下载 CDNS 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:41,544 - INFO - 成功获取 2513 行 CDNS 的数据
2025-03-09 02:14:41,544 - INFO - 为 CDNS 创建特征...
2025-03-09 02:14:41,712 - INFO - 获取市场指数数据...
2025-03-09 02:14:41,980 - INFO - 已添加 2513 行来自 CDNS 的数据
2025-03-09 02:14:41,980 - INFO - 处理股票 INTU (27/30) 的数据...
2025-03-09 02:14:41,981 - INFO - 下载 INTU 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:42,466 - INFO - 成功获取 2513 行 INTU 的数据
2025-03-09 02:14:42,467 - INFO - 为 INTU 创建特征...
2025-03-09 02:14:42,558 - INFO - 获取市场指数数据...
2025-03-09 02:14:42,741 - INFO - 已添加 2513 行来自 INTU 的数据
2025-03-09 02:14:42,741 - INFO - 处理股票 ADI (28/30) 的数据...
2025-03-09 02:14:42,741 - INFO - 下载 ADI 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:43,275 - INFO - 成功获取 2513 行 ADI 的数据
2025-03-09 02:14:43,275 - INFO - 为 ADI 创建特征...
2025-03-09 02:14:43,367 - INFO - 获取市场指数数据...
2025-03-09 02:14:43,559 - INFO - 已添加 2513 行来自 ADI 的数据
2025-03-09 02:14:43,560 - INFO - 处理股票 UBER (29/30) 的数据...
2025-03-09 02:14:43,560 - INFO - 下载 UBER 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:43,838 - INFO - 成功获取 1465 行 UBER 的数据
2025-03-09 02:14:43,839 - INFO - 为 UBER 创建特征...
2025-03-09 02:14:43,930 - INFO - 获取市场指数数据...
2025-03-09 02:14:44,111 - INFO - 已添加 1465 行来自 UBER 的数据
2025-03-09 02:14:44,111 - INFO - 处理股票 ABNB (30/30) 的数据...
2025-03-09 02:14:44,111 - INFO - 下载 ABNB 的历史数据 (从 2015-03-12 到 2025-03-09)...
2025-03-09 02:14:44,373 - INFO - 成功获取 1064 行 ABNB 的数据
2025-03-09 02:14:44,374 - INFO - 为 ABNB 创建特征...
2025-03-09 02:14:44,465 - INFO - 获取市场指数数据...
2025-03-09 02:14:44,649 - INFO - 已添加 1064 行来自 ABNB 的数据
2025-03-09 02:14:44,649 - INFO - 暂停2秒，避免达到API限制...
2025-03-09 02:14:46,655 - INFO - 总共收集了 72814 行数据
2025-03-09 02:14:46,656 - WARNING - 合并后的数据索引不是日期类型，这可能影响时间序列分析
2025-03-09 02:14:46,657 - INFO - 索引类型: <class 'pandas.core.indexes.multi.MultiIndex'>
2025-03-09 02:14:46,671 - INFO - 索引示例: MultiIndex([('2015-03-12', 'AAPL'),
            ('2015-03-13', 'AAPL'),
            ('2015-03-16', 'AAPL'),
            ('2015-03-17', 'AAPL'),
            ('2015-03-18', 'AAPL')],
           names=['Date', 'ticker_temp'])
2025-03-09 02:14:46,672 - INFO - 检测到MultiIndex，提取日期部分和股票标识...
2025-03-09 02:14:46,675 - INFO - 日期范围: 2015-03-12 00:00:00 到 2025-03-07 00:00:00
2025-03-09 02:14:46,682 - INFO - 不同股票数量: 30
2025-03-09 02:16:24,436 - INFO - 计算时间衰减权重...
2025-03-09 02:16:24,436 - INFO - 检测到MultiIndex，提取日期部分计算权重...
2025-03-09 02:16:24,670 - INFO - 使用MultiIndex时间衰减权重: 最大权重=3.96, 最小权重=0.07
2025-03-09 02:16:24,670 - INFO - 训练模型: RandomForest...
2025-03-09 02:16:58,030 - INFO - 训练模型: GradientBoosting...
2025-03-09 02:19:02,559 - INFO - 训练模型: ExtraTrees...
2025-03-09 02:19:07,354 - INFO - 模型使用的特征总数: 33
2025-03-09 02:19:07,354 - INFO - 前10个特征:
2025-03-09 02:19:07,354 - INFO -   1. vix_ma20
2025-03-09 02:19:07,354 - INFO -   2. volatility_10d_change
2025-03-09 02:19:07,354 - INFO -   3. returns_1d
2025-03-09 02:19:07,354 - INFO -   4. ma5_ratio
2025-03-09 02:19:07,355 - INFO -   5. price_volume_ratio
2025-03-09 02:19:07,355 - INFO -   6. ma200_ratio
2025-03-09 02:19:07,355 - INFO -   7. returns_5d
2025-03-09 02:19:07,355 - INFO -   8. volatility_50d
2025-03-09 02:19:07,355 - INFO -   9. vix
2025-03-09 02:19:07,355 - INFO -   10. ma20_ratio
2025-03-09 02:19:07,671 - INFO - 模型已保存到 models/master_model.pkl
2025-03-09 02:19:07,977 - INFO - 模型历史版本已保存: models/master_model_TECH.pkl
2025-03-09 02:19:07,978 - INFO - 特征列信息已保存到 models/master_model_features.txt
2025-03-09 02:19:07,990 - INFO - 样本数据已保存到 models/master_model_sample.csv
2025-03-09 02:28:45,887 - ERROR - 
1 Failed download:
2025-03-09 02:28:45,888 - ERROR - ['AAPL']: SSLError(MaxRetryError("HTTPSConnectionPool(host='query1.finance.yahoo.com', port=443): Max retries exceeded with url: /v1/test/getcrumb (Caused by SSLError(SSLEOFError(8, 'EOF occurred in violation of protocol (_ssl.c:1129)')))"))
